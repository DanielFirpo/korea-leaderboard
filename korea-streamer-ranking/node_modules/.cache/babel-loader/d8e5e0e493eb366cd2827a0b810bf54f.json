{"ast":null,"code":"\"use strict\";\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Frame = exports.FrameManager = exports.FrameManagerEmittedEvents = void 0;\n\nconst EventEmitter_js_1 = require(\"./EventEmitter.js\");\n\nconst assert_js_1 = require(\"./assert.js\");\n\nconst helper_js_1 = require(\"./helper.js\");\n\nconst ExecutionContext_js_1 = require(\"./ExecutionContext.js\");\n\nconst LifecycleWatcher_js_1 = require(\"./LifecycleWatcher.js\");\n\nconst DOMWorld_js_1 = require(\"./DOMWorld.js\");\n\nconst NetworkManager_js_1 = require(\"./NetworkManager.js\");\n\nconst Connection_js_1 = require(\"./Connection.js\");\n\nconst UTILITY_WORLD_NAME = '__puppeteer_utility_world__';\nconst xPathPattern = /^\\(\\/\\/[^\\)]+\\)|^\\/\\//;\n/**\n * We use symbols to prevent external parties listening to these events.\n * They are internal to Puppeteer.\n *\n * @internal\n */\n\nexports.FrameManagerEmittedEvents = {\n  FrameAttached: Symbol('FrameManager.FrameAttached'),\n  FrameNavigated: Symbol('FrameManager.FrameNavigated'),\n  FrameDetached: Symbol('FrameManager.FrameDetached'),\n  FrameSwapped: Symbol('FrameManager.FrameSwapped'),\n  LifecycleEvent: Symbol('FrameManager.LifecycleEvent'),\n  FrameNavigatedWithinDocument: Symbol('FrameManager.FrameNavigatedWithinDocument'),\n  ExecutionContextCreated: Symbol('FrameManager.ExecutionContextCreated'),\n  ExecutionContextDestroyed: Symbol('FrameManager.ExecutionContextDestroyed')\n};\n/**\n * @internal\n */\n\nclass FrameManager extends EventEmitter_js_1.EventEmitter {\n  constructor(client, page, ignoreHTTPSErrors, timeoutSettings) {\n    super();\n    this._frames = new Map();\n    this._contextIdToContext = new Map();\n    this._isolatedWorlds = new Set();\n    this._client = client;\n    this._page = page;\n    this._networkManager = new NetworkManager_js_1.NetworkManager(client, ignoreHTTPSErrors, this);\n    this._timeoutSettings = timeoutSettings;\n    this.setupEventListeners(this._client);\n  }\n\n  setupEventListeners(session) {\n    session.on('Page.frameAttached', event => {\n      this._onFrameAttached(session, event.frameId, event.parentFrameId);\n    });\n    session.on('Page.frameNavigated', event => {\n      this._onFrameNavigated(event.frame);\n    });\n    session.on('Page.navigatedWithinDocument', event => {\n      this._onFrameNavigatedWithinDocument(event.frameId, event.url);\n    });\n    session.on('Page.frameDetached', event => {\n      this._onFrameDetached(event.frameId, event.reason);\n    });\n    session.on('Page.frameStoppedLoading', event => {\n      this._onFrameStoppedLoading(event.frameId);\n    });\n    session.on('Runtime.executionContextCreated', event => {\n      this._onExecutionContextCreated(event.context, session);\n    });\n    session.on('Runtime.executionContextDestroyed', event => {\n      this._onExecutionContextDestroyed(event.executionContextId, session);\n    });\n    session.on('Runtime.executionContextsCleared', () => {\n      this._onExecutionContextsCleared(session);\n    });\n    session.on('Page.lifecycleEvent', event => {\n      this._onLifecycleEvent(event);\n    });\n    session.on('Target.attachedToTarget', async event => {\n      this._onAttachedToTarget(event);\n    });\n    session.on('Target.detachedFromTarget', async event => {\n      this._onDetachedFromTarget(event);\n    });\n  }\n\n  async initialize() {\n    let client = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._client;\n\n    try {\n      const result = await Promise.all([client.send('Page.enable'), client.send('Page.getFrameTree')]);\n      const {\n        frameTree\n      } = result[1];\n\n      this._handleFrameTree(client, frameTree);\n\n      await Promise.all([client.send('Page.setLifecycleEventsEnabled', {\n        enabled: true\n      }), client.send('Runtime.enable').then(() => this._ensureIsolatedWorld(client, UTILITY_WORLD_NAME)), // TODO: Network manager is not aware of OOP iframes yet.\n      client === this._client ? this._networkManager.initialize() : Promise.resolve()]);\n    } catch (error) {\n      // The target might have been closed before the initialization finished.\n      if (error.message.includes('Target closed') || error.message.includes('Session closed')) {\n        return;\n      }\n\n      throw error;\n    }\n  }\n\n  networkManager() {\n    return this._networkManager;\n  }\n\n  async navigateFrame(frame, url) {\n    let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    assertNoLegacyNavigationOptions(options);\n    const {\n      referer = this._networkManager.extraHTTPHeaders()['referer'],\n      waitUntil = ['load'],\n      timeout = this._timeoutSettings.navigationTimeout()\n    } = options;\n    const watcher = new LifecycleWatcher_js_1.LifecycleWatcher(this, frame, waitUntil, timeout);\n    let ensureNewDocumentNavigation = false;\n    let error = await Promise.race([navigate(this._client, url, referer, frame._id), watcher.timeoutOrTerminationPromise()]);\n\n    if (!error) {\n      error = await Promise.race([watcher.timeoutOrTerminationPromise(), ensureNewDocumentNavigation ? watcher.newDocumentNavigationPromise() : watcher.sameDocumentNavigationPromise()]);\n    }\n\n    watcher.dispose();\n    if (error) throw error;\n    return await watcher.navigationResponse();\n\n    async function navigate(client, url, referrer, frameId) {\n      try {\n        const response = await client.send('Page.navigate', {\n          url,\n          referrer,\n          frameId\n        });\n        ensureNewDocumentNavigation = !!response.loaderId;\n        return response.errorText ? new Error(`${response.errorText} at ${url}`) : null;\n      } catch (error) {\n        return error;\n      }\n    }\n  }\n\n  async waitForFrameNavigation(frame) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    assertNoLegacyNavigationOptions(options);\n    const {\n      waitUntil = ['load'],\n      timeout = this._timeoutSettings.navigationTimeout()\n    } = options;\n    const watcher = new LifecycleWatcher_js_1.LifecycleWatcher(this, frame, waitUntil, timeout);\n    const error = await Promise.race([watcher.timeoutOrTerminationPromise(), watcher.sameDocumentNavigationPromise(), watcher.newDocumentNavigationPromise()]);\n    watcher.dispose();\n    if (error) throw error;\n    return await watcher.navigationResponse();\n  }\n\n  async _onAttachedToTarget(event) {\n    if (event.targetInfo.type !== 'iframe') {\n      return;\n    }\n\n    const frame = this._frames.get(event.targetInfo.targetId);\n\n    const session = Connection_js_1.Connection.fromSession(this._client).session(event.sessionId);\n    if (frame) frame._updateClient(session);\n    this.setupEventListeners(session);\n    await this.initialize(session);\n  }\n\n  async _onDetachedFromTarget(event) {\n    const frame = this._frames.get(event.targetId);\n\n    if (frame && frame.isOOPFrame()) {\n      // When an OOP iframe is removed from the page, it\n      // will only get a Target.detachedFromTarget event.\n      this._removeFramesRecursively(frame);\n    }\n  }\n\n  _onLifecycleEvent(event) {\n    const frame = this._frames.get(event.frameId);\n\n    if (!frame) return;\n\n    frame._onLifecycleEvent(event.loaderId, event.name);\n\n    this.emit(exports.FrameManagerEmittedEvents.LifecycleEvent, frame);\n  }\n\n  _onFrameStoppedLoading(frameId) {\n    const frame = this._frames.get(frameId);\n\n    if (!frame) return;\n\n    frame._onLoadingStopped();\n\n    this.emit(exports.FrameManagerEmittedEvents.LifecycleEvent, frame);\n  }\n\n  _handleFrameTree(session, frameTree) {\n    if (frameTree.frame.parentId) {\n      this._onFrameAttached(session, frameTree.frame.id, frameTree.frame.parentId);\n    }\n\n    this._onFrameNavigated(frameTree.frame);\n\n    if (!frameTree.childFrames) return;\n\n    for (const child of frameTree.childFrames) {\n      this._handleFrameTree(session, child);\n    }\n  }\n\n  page() {\n    return this._page;\n  }\n\n  mainFrame() {\n    return this._mainFrame;\n  }\n\n  frames() {\n    return Array.from(this._frames.values());\n  }\n\n  frame(frameId) {\n    return this._frames.get(frameId) || null;\n  }\n\n  _onFrameAttached(session, frameId, parentFrameId) {\n    if (this._frames.has(frameId)) {\n      const frame = this._frames.get(frameId);\n\n      if (session && frame.isOOPFrame()) {\n        // If an OOP iframes becomes a normal iframe again\n        // it is first attached to the parent page before\n        // the target is removed.\n        frame._updateClient(session);\n      }\n\n      return;\n    }\n\n    (0, assert_js_1.assert)(parentFrameId);\n\n    const parentFrame = this._frames.get(parentFrameId);\n\n    const frame = new Frame(this, parentFrame, frameId, session);\n\n    this._frames.set(frame._id, frame);\n\n    this.emit(exports.FrameManagerEmittedEvents.FrameAttached, frame);\n  }\n\n  _onFrameNavigated(framePayload) {\n    const isMainFrame = !framePayload.parentId;\n    let frame = isMainFrame ? this._mainFrame : this._frames.get(framePayload.id);\n    (0, assert_js_1.assert)(isMainFrame || frame, 'We either navigate top level or have old version of the navigated frame'); // Detach all child frames first.\n\n    if (frame) {\n      for (const child of frame.childFrames()) this._removeFramesRecursively(child);\n    } // Update or create main frame.\n\n\n    if (isMainFrame) {\n      if (frame) {\n        // Update frame id to retain frame identity on cross-process navigation.\n        this._frames.delete(frame._id);\n\n        frame._id = framePayload.id;\n      } else {\n        // Initial main frame navigation.\n        frame = new Frame(this, null, framePayload.id, this._client);\n      }\n\n      this._frames.set(framePayload.id, frame);\n\n      this._mainFrame = frame;\n    } // Update frame payload.\n\n\n    frame._navigated(framePayload);\n\n    this.emit(exports.FrameManagerEmittedEvents.FrameNavigated, frame);\n  }\n\n  async _ensureIsolatedWorld(session, name) {\n    const key = `${session.id()}:${name}`;\n    if (this._isolatedWorlds.has(key)) return;\n\n    this._isolatedWorlds.add(key);\n\n    await session.send('Page.addScriptToEvaluateOnNewDocument', {\n      source: `//# sourceURL=${ExecutionContext_js_1.EVALUATION_SCRIPT_URL}`,\n      worldName: name\n    }); // Frames might be removed before we send this.\n\n    await Promise.all(this.frames().filter(frame => frame._client === session).map(frame => session.send('Page.createIsolatedWorld', {\n      frameId: frame._id,\n      worldName: name,\n      grantUniveralAccess: true\n    }).catch(helper_js_1.debugError)));\n  }\n\n  _onFrameNavigatedWithinDocument(frameId, url) {\n    const frame = this._frames.get(frameId);\n\n    if (!frame) return;\n\n    frame._navigatedWithinDocument(url);\n\n    this.emit(exports.FrameManagerEmittedEvents.FrameNavigatedWithinDocument, frame);\n    this.emit(exports.FrameManagerEmittedEvents.FrameNavigated, frame);\n  }\n\n  _onFrameDetached(frameId, reason) {\n    const frame = this._frames.get(frameId);\n\n    if (reason === 'remove') {\n      // Only remove the frame if the reason for the detached event is\n      // an actual removement of the frame.\n      // For frames that become OOP iframes, the reason would be 'swap'.\n      if (frame) this._removeFramesRecursively(frame);\n    } else if (reason === 'swap') {\n      this.emit(exports.FrameManagerEmittedEvents.FrameSwapped, frame);\n    }\n  }\n\n  _onExecutionContextCreated(contextPayload, session) {\n    const auxData = contextPayload.auxData;\n    const frameId = auxData ? auxData.frameId : null;\n    const frame = this._frames.get(frameId) || null;\n    let world = null;\n\n    if (frame) {\n      // Only care about execution contexts created for the current session.\n      if (frame._client !== session) return;\n\n      if (contextPayload.auxData && !!contextPayload.auxData['isDefault']) {\n        world = frame._mainWorld;\n      } else if (contextPayload.name === UTILITY_WORLD_NAME && !frame._secondaryWorld._hasContext()) {\n        // In case of multiple sessions to the same target, there's a race between\n        // connections so we might end up creating multiple isolated worlds.\n        // We can use either.\n        world = frame._secondaryWorld;\n      }\n    }\n\n    const context = new ExecutionContext_js_1.ExecutionContext((frame === null || frame === void 0 ? void 0 : frame._client) || this._client, contextPayload, world);\n    if (world) world._setContext(context);\n    const key = `${session.id()}:${contextPayload.id}`;\n\n    this._contextIdToContext.set(key, context);\n  }\n\n  _onExecutionContextDestroyed(executionContextId, session) {\n    const key = `${session.id()}:${executionContextId}`;\n\n    const context = this._contextIdToContext.get(key);\n\n    if (!context) return;\n\n    this._contextIdToContext.delete(key);\n\n    if (context._world) context._world._setContext(null);\n  }\n\n  _onExecutionContextsCleared(session) {\n    for (const [key, context] of this._contextIdToContext.entries()) {\n      // Make sure to only clear execution contexts that belong\n      // to the current session.\n      if (context._client !== session) continue;\n      if (context._world) context._world._setContext(null);\n\n      this._contextIdToContext.delete(key);\n    }\n  }\n\n  executionContextById(contextId) {\n    let session = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._client;\n    const key = `${session.id()}:${contextId}`;\n\n    const context = this._contextIdToContext.get(key);\n\n    (0, assert_js_1.assert)(context, 'INTERNAL ERROR: missing context with id = ' + contextId);\n    return context;\n  }\n\n  _removeFramesRecursively(frame) {\n    for (const child of frame.childFrames()) this._removeFramesRecursively(child);\n\n    frame._detach();\n\n    this._frames.delete(frame._id);\n\n    this.emit(exports.FrameManagerEmittedEvents.FrameDetached, frame);\n  }\n\n}\n\nexports.FrameManager = FrameManager;\n/**\n * At every point of time, page exposes its current frame tree via the\n * {@link Page.mainFrame | page.mainFrame} and\n * {@link Frame.childFrames | frame.childFrames} methods.\n *\n * @remarks\n *\n * `Frame` object lifecycles are controlled by three events that are all\n * dispatched on the page object:\n *\n * - {@link PageEmittedEvents.FrameAttached}\n *\n * - {@link PageEmittedEvents.FrameNavigated}\n *\n * - {@link PageEmittedEvents.FrameDetached}\n *\n * @Example\n * An example of dumping frame tree:\n *\n * ```js\n * const puppeteer = require('puppeteer');\n *\n * (async () => {\n *   const browser = await puppeteer.launch();\n *   const page = await browser.newPage();\n *   await page.goto('https://www.google.com/chrome/browser/canary.html');\n *   dumpFrameTree(page.mainFrame(), '');\n *   await browser.close();\n *\n *   function dumpFrameTree(frame, indent) {\n *     console.log(indent + frame.url());\n *     for (const child of frame.childFrames()) {\n *     dumpFrameTree(child, indent + '  ');\n *     }\n *   }\n * })();\n * ```\n *\n * @Example\n * An example of getting text from an iframe element:\n *\n * ```js\n * const frame = page.frames().find(frame => frame.name() === 'myframe');\n * const text = await frame.$eval('.selector', element => element.textContent);\n * console.log(text);\n * ```\n *\n * @public\n */\n\nclass Frame {\n  /**\n   * @internal\n   */\n  constructor(frameManager, parentFrame, frameId, client) {\n    this._url = '';\n    this._detached = false;\n    /**\n     * @internal\n     */\n\n    this._loaderId = '';\n    /**\n     * @internal\n     */\n\n    this._lifecycleEvents = new Set();\n    this._frameManager = frameManager;\n    this._parentFrame = parentFrame;\n    this._url = '';\n    this._id = frameId;\n    this._detached = false;\n    this._loaderId = '';\n    this._childFrames = new Set();\n    if (this._parentFrame) this._parentFrame._childFrames.add(this);\n\n    this._updateClient(client);\n  }\n  /**\n   * @internal\n   */\n\n\n  _updateClient(client) {\n    this._client = client;\n    this._mainWorld = new DOMWorld_js_1.DOMWorld(this._client, this._frameManager, this, this._frameManager._timeoutSettings);\n    this._secondaryWorld = new DOMWorld_js_1.DOMWorld(this._client, this._frameManager, this, this._frameManager._timeoutSettings);\n  }\n  /**\n   * @remarks\n   *\n   * @returns `true` if the frame is an OOP frame, or `false` otherwise.\n   */\n\n\n  isOOPFrame() {\n    return this._client !== this._frameManager._client;\n  }\n  /**\n   * @remarks\n   *\n   * `frame.goto` will throw an error if:\n   * - there's an SSL error (e.g. in case of self-signed certificates).\n   *\n   * - target URL is invalid.\n   *\n   * - the `timeout` is exceeded during navigation.\n   *\n   * - the remote server does not respond or is unreachable.\n   *\n   * - the main resource failed to load.\n   *\n   * `frame.goto` will not throw an error when any valid HTTP status code is\n   * returned by the remote server, including 404 \"Not Found\" and 500 \"Internal\n   * Server Error\".  The status code for such responses can be retrieved by\n   * calling {@link HTTPResponse.status}.\n   *\n   * NOTE: `frame.goto` either throws an error or returns a main resource\n   * response. The only exceptions are navigation to `about:blank` or\n   * navigation to the same URL with a different hash, which would succeed and\n   * return `null`.\n   *\n   * NOTE: Headless mode doesn't support navigation to a PDF document. See\n   * the {@link https://bugs.chromium.org/p/chromium/issues/detail?id=761295 | upstream\n   * issue}.\n   *\n   * @param url - the URL to navigate the frame to. This should include the\n   * scheme, e.g. `https://`.\n   * @param options - navigation options. `waitUntil` is useful to define when\n   * the navigation should be considered successful - see the docs for\n   * {@link PuppeteerLifeCycleEvent} for more details.\n   *\n   * @returns A promise which resolves to the main resource response. In case of\n   * multiple redirects, the navigation will resolve with the response of the\n   * last redirect.\n   */\n\n\n  async goto(url) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._frameManager.navigateFrame(this, url, options);\n  }\n  /**\n   * @remarks\n   *\n   * This resolves when the frame navigates to a new URL. It is useful for when\n   * you run code which will indirectly cause the frame to navigate. Consider\n   * this example:\n   *\n   * ```js\n   * const [response] = await Promise.all([\n   *   // The navigation promise resolves after navigation has finished\n   *   frame.waitForNavigation(),\n   *   // Clicking the link will indirectly cause a navigation\n   *   frame.click('a.my-link'),\n   * ]);\n   * ```\n   *\n   * Usage of the {@link https://developer.mozilla.org/en-US/docs/Web/API/History_API | History API} to change the URL is considered a navigation.\n   *\n   * @param options - options to configure when the navigation is consided finished.\n   * @returns a promise that resolves when the frame navigates to a new URL.\n   */\n\n\n  async waitForNavigation() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return await this._frameManager.waitForFrameNavigation(this, options);\n  }\n  /**\n   * @internal\n   */\n\n\n  client() {\n    return this._client;\n  }\n  /**\n   * @returns a promise that resolves to the frame's default execution context.\n   */\n\n\n  executionContext() {\n    return this._mainWorld.executionContext();\n  }\n  /**\n   * @remarks\n   *\n   * The only difference between {@link Frame.evaluate} and\n   * `frame.evaluateHandle` is that `evaluateHandle` will return the value\n   * wrapped in an in-page object.\n   *\n   * This method behaves identically to {@link Page.evaluateHandle} except it's\n   * run within the context of the `frame`, rather than the entire page.\n   *\n   * @param pageFunction - a function that is run within the frame\n   * @param args - arguments to be passed to the pageFunction\n   */\n\n\n  async evaluateHandle(pageFunction) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    return this._mainWorld.evaluateHandle(pageFunction, ...args);\n  }\n  /**\n   * @remarks\n   *\n   * This method behaves identically to {@link Page.evaluate} except it's run\n   * within the context of the `frame`, rather than the entire page.\n   *\n   * @param pageFunction - a function that is run within the frame\n   * @param args - arguments to be passed to the pageFunction\n   */\n\n\n  async evaluate(pageFunction) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    return this._mainWorld.evaluate(pageFunction, ...args);\n  }\n  /**\n   * This method queries the frame for the given selector.\n   *\n   * @param selector - a selector to query for.\n   * @returns A promise which resolves to an `ElementHandle` pointing at the\n   * element, or `null` if it was not found.\n   */\n\n\n  async $(selector) {\n    return this._mainWorld.$(selector);\n  }\n  /**\n   * This method evaluates the given XPath expression and returns the results.\n   *\n   * @param expression - the XPath expression to evaluate.\n   */\n\n\n  async $x(expression) {\n    return this._mainWorld.$x(expression);\n  }\n  /**\n   * @remarks\n   *\n   * This method runs `document.querySelector` within\n   * the frame and passes it as the first argument to `pageFunction`.\n   *\n   * If `pageFunction` returns a Promise, then `frame.$eval` would wait for\n   * the promise to resolve and return its value.\n   *\n   * @example\n   *\n   * ```js\n   * const searchValue = await frame.$eval('#search', el => el.value);\n   * ```\n   *\n   * @param selector - the selector to query for\n   * @param pageFunction - the function to be evaluated in the frame's context\n   * @param args - additional arguments to pass to `pageFunction`\n   */\n\n\n  async $eval(selector, pageFunction) {\n    for (var _len3 = arguments.length, args = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {\n      args[_key3 - 2] = arguments[_key3];\n    }\n\n    return this._mainWorld.$eval(selector, pageFunction, ...args);\n  }\n  /**\n   * @remarks\n   *\n   * This method runs `Array.from(document.querySelectorAll(selector))` within\n   * the frame and passes it as the first argument to `pageFunction`.\n   *\n   * If `pageFunction` returns a Promise, then `frame.$$eval` would wait for\n   * the promise to resolve and return its value.\n   *\n   * @example\n   *\n   * ```js\n   * const divsCounts = await frame.$$eval('div', divs => divs.length);\n   * ```\n   *\n   * @param selector - the selector to query for\n   * @param pageFunction - the function to be evaluated in the frame's context\n   * @param args - additional arguments to pass to `pageFunction`\n   */\n\n\n  async $$eval(selector, pageFunction) {\n    for (var _len4 = arguments.length, args = new Array(_len4 > 2 ? _len4 - 2 : 0), _key4 = 2; _key4 < _len4; _key4++) {\n      args[_key4 - 2] = arguments[_key4];\n    }\n\n    return this._mainWorld.$$eval(selector, pageFunction, ...args);\n  }\n  /**\n   * This runs `document.querySelectorAll` in the frame and returns the result.\n   *\n   * @param selector - a selector to search for\n   * @returns An array of element handles pointing to the found frame elements.\n   */\n\n\n  async $$(selector) {\n    return this._mainWorld.$$(selector);\n  }\n  /**\n   * @returns the full HTML contents of the frame, including the doctype.\n   */\n\n\n  async content() {\n    return this._secondaryWorld.content();\n  }\n  /**\n   * Set the content of the frame.\n   *\n   * @param html - HTML markup to assign to the page.\n   * @param options - options to configure how long before timing out and at\n   * what point to consider the content setting successful.\n   */\n\n\n  async setContent(html) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return this._secondaryWorld.setContent(html, options);\n  }\n  /**\n   * @remarks\n   *\n   * If the name is empty, it returns the `id` attribute instead.\n   *\n   * Note: This value is calculated once when the frame is created, and will not\n   * update if the attribute is changed later.\n   *\n   * @returns the frame's `name` attribute as specified in the tag.\n   */\n\n\n  name() {\n    return this._name || '';\n  }\n  /**\n   * @returns the frame's URL.\n   */\n\n\n  url() {\n    return this._url;\n  }\n  /**\n   * @returns the parent `Frame`, if any. Detached and main frames return `null`.\n   */\n\n\n  parentFrame() {\n    return this._parentFrame;\n  }\n  /**\n   * @returns an array of child frames.\n   */\n\n\n  childFrames() {\n    return Array.from(this._childFrames);\n  }\n  /**\n   * @returns `true` if the frame has been detached, or `false` otherwise.\n   */\n\n\n  isDetached() {\n    return this._detached;\n  }\n  /**\n   * Adds a `<script>` tag into the page with the desired url or content.\n   *\n   * @param options - configure the script to add to the page.\n   *\n   * @returns a promise that resolves to the added tag when the script's\n   * `onload` event fires or when the script content was injected into the\n   * frame.\n   */\n\n\n  async addScriptTag(options) {\n    return this._mainWorld.addScriptTag(options);\n  }\n  /**\n   * Adds a `<link rel=\"stylesheet\">` tag into the page with the desired url or\n   * a `<style type=\"text/css\">` tag with the content.\n   *\n   * @param options - configure the CSS to add to the page.\n   *\n   * @returns a promise that resolves to the added tag when the stylesheets's\n   * `onload` event fires or when the CSS content was injected into the\n   * frame.\n   */\n\n\n  async addStyleTag(options) {\n    return this._mainWorld.addStyleTag(options);\n  }\n  /**\n   *\n   * This method clicks the first element found that matches `selector`.\n   *\n   * @remarks\n   *\n   * This method scrolls the element into view if needed, and then uses\n   * {@link Page.mouse} to click in the center of the element. If there's no\n   * element matching `selector`, the method throws an error.\n   *\n   * Bear in mind that if `click()` triggers a navigation event and there's a\n   * separate `page.waitForNavigation()` promise to be resolved, you may end up\n   * with a race condition that yields unexpected results. The correct pattern\n   * for click and wait for navigation is the following:\n   *\n   * ```javascript\n   * const [response] = await Promise.all([\n   *   page.waitForNavigation(waitOptions),\n   *   frame.click(selector, clickOptions),\n   * ]);\n   * ```\n   * @param selector - the selector to search for to click. If there are\n   * multiple elements, the first will be clicked.\n   */\n\n\n  async click(selector) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return this._secondaryWorld.click(selector, options);\n  }\n  /**\n   * This method fetches an element with `selector` and focuses it.\n   *\n   * @remarks\n   * If there's no element matching `selector`, the method throws an error.\n   *\n   * @param selector - the selector for the element to focus. If there are\n   * multiple elements, the first will be focused.\n   */\n\n\n  async focus(selector) {\n    return this._secondaryWorld.focus(selector);\n  }\n  /**\n   * This method fetches an element with `selector`, scrolls it into view if\n   * needed, and then uses {@link Page.mouse} to hover over the center of the\n   * element.\n   *\n   * @remarks\n   * If there's no element matching `selector`, the method throws an\n   *\n   * @param selector - the selector for the element to hover. If there are\n   * multiple elements, the first will be hovered.\n   */\n\n\n  async hover(selector) {\n    return this._secondaryWorld.hover(selector);\n  }\n  /**\n   * Triggers a `change` and `input` event once all the provided options have\n   * been selected.\n   *\n   * @remarks\n   *\n   * If there's no `<select>` element matching `selector`, the\n   * method throws an error.\n   *\n   * @example\n   * ```js\n   * frame.select('select#colors', 'blue'); // single selection\n   * frame.select('select#colors', 'red', 'green', 'blue'); // multiple selections\n   * ```\n   *\n   * @param selector - a selector to query the frame for\n   * @param values - an array of values to select. If the `<select>` has the\n   * `multiple` attribute, all values are considered, otherwise only the first\n   * one is taken into account.\n   * @returns the list of values that were successfully selected.\n   */\n\n\n  select(selector) {\n    for (var _len5 = arguments.length, values = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n      values[_key5 - 1] = arguments[_key5];\n    }\n\n    return this._secondaryWorld.select(selector, ...values);\n  }\n  /**\n   * This method fetches an element with `selector`, scrolls it into view if\n   * needed, and then uses {@link Page.touchscreen} to tap in the center of the\n   * element.\n   *\n   * @remarks\n   *\n   * If there's no element matching `selector`, the method throws an error.\n   *\n   * @param selector - the selector to tap.\n   * @returns a promise that resolves when the element has been tapped.\n   */\n\n\n  async tap(selector) {\n    return this._secondaryWorld.tap(selector);\n  }\n  /**\n   * Sends a `keydown`, `keypress`/`input`, and `keyup` event for each character\n   * in the text.\n   *\n   * @remarks\n   * To press a special key, like `Control` or `ArrowDown`, use\n   * {@link Keyboard.press}.\n   *\n   * @example\n   * ```js\n   * await frame.type('#mytextarea', 'Hello'); // Types instantly\n   * await frame.type('#mytextarea', 'World', {delay: 100}); // Types slower, like a user\n   * ```\n   *\n   * @param selector - the selector for the element to type into. If there are\n   * multiple the first will be used.\n   * @param text - text to type into the element\n   * @param options - takes one option, `delay`, which sets the time to wait\n   * between key presses in milliseconds. Defaults to `0`.\n   *\n   * @returns a promise that resolves when the typing is complete.\n   */\n\n\n  async type(selector, text, options) {\n    return this._mainWorld.type(selector, text, options);\n  }\n  /**\n   * @remarks\n   *\n   * This method behaves differently depending on the first parameter. If it's a\n   * `string`, it will be treated as a `selector` or `xpath` (if the string\n   * starts with `//`). This method then is a shortcut for\n   * {@link Frame.waitForSelector} or {@link Frame.waitForXPath}.\n   *\n   * If the first argument is a function this method is a shortcut for\n   * {@link Frame.waitForFunction}.\n   *\n   * If the first argument is a `number`, it's treated as a timeout in\n   * milliseconds and the method returns a promise which resolves after the\n   * timeout.\n   *\n   * @param selectorOrFunctionOrTimeout - a selector, predicate or timeout to\n   * wait for.\n   * @param options - optional waiting parameters.\n   * @param args - arguments to pass to `pageFunction`.\n   *\n   * @deprecated Don't use this method directly. Instead use the more explicit\n   * methods available: {@link Frame.waitForSelector},\n   * {@link Frame.waitForXPath}, {@link Frame.waitForFunction} or\n   * {@link Frame.waitForTimeout}.\n   */\n\n\n  waitFor(selectorOrFunctionOrTimeout) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    console.warn('waitFor is deprecated and will be removed in a future release. See https://github.com/puppeteer/puppeteer/issues/6214 for details and how to migrate your code.');\n\n    if (helper_js_1.helper.isString(selectorOrFunctionOrTimeout)) {\n      const string = selectorOrFunctionOrTimeout;\n      if (xPathPattern.test(string)) return this.waitForXPath(string, options);\n      return this.waitForSelector(string, options);\n    }\n\n    if (helper_js_1.helper.isNumber(selectorOrFunctionOrTimeout)) return new Promise(fulfill => setTimeout(fulfill, selectorOrFunctionOrTimeout));\n\n    for (var _len6 = arguments.length, args = new Array(_len6 > 2 ? _len6 - 2 : 0), _key6 = 2; _key6 < _len6; _key6++) {\n      args[_key6 - 2] = arguments[_key6];\n    }\n\n    if (typeof selectorOrFunctionOrTimeout === 'function') return this.waitForFunction(selectorOrFunctionOrTimeout, options, ...args);\n    return Promise.reject(new Error('Unsupported target type: ' + typeof selectorOrFunctionOrTimeout));\n  }\n  /**\n   * Causes your script to wait for the given number of milliseconds.\n   *\n   * @remarks\n   * It's generally recommended to not wait for a number of seconds, but instead\n   * use {@link Frame.waitForSelector}, {@link Frame.waitForXPath} or\n   * {@link Frame.waitForFunction} to wait for exactly the conditions you want.\n   *\n   * @example\n   *\n   * Wait for 1 second:\n   *\n   * ```\n   * await frame.waitForTimeout(1000);\n   * ```\n   *\n   * @param milliseconds - the number of milliseconds to wait.\n   */\n\n\n  waitForTimeout(milliseconds) {\n    return new Promise(resolve => {\n      setTimeout(resolve, milliseconds);\n    });\n  }\n  /**\n   * @remarks\n   *\n   *\n   * Wait for the `selector` to appear in page. If at the moment of calling the\n   * method the `selector` already exists, the method will return immediately.\n   * If the selector doesn't appear after the `timeout` milliseconds of waiting,\n   * the function will throw.\n   *\n   * This method works across navigations.\n   *\n   * @example\n   * ```js\n   * const puppeteer = require('puppeteer');\n   *\n   * (async () => {\n   *   const browser = await puppeteer.launch();\n   *   const page = await browser.newPage();\n   *   let currentURL;\n   *   page.mainFrame()\n   *   .waitForSelector('img')\n   *   .then(() => console.log('First URL with image: ' + currentURL));\n   *\n   *   for (currentURL of ['https://example.com', 'https://google.com', 'https://bbc.com']) {\n   *     await page.goto(currentURL);\n   *   }\n   *   await browser.close();\n   * })();\n   * ```\n   * @param selector - the selector to wait for.\n   * @param options - options to define if the element should be visible and how\n   * long to wait before timing out.\n   * @returns a promise which resolves when an element matching the selector\n   * string is added to the DOM.\n   */\n\n\n  async waitForSelector(selector) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const handle = await this._secondaryWorld.waitForSelector(selector, options);\n    if (!handle) return null;\n    const mainExecutionContext = await this._mainWorld.executionContext();\n    const result = await mainExecutionContext._adoptElementHandle(handle);\n    await handle.dispose();\n    return result;\n  }\n  /**\n   * @remarks\n   * Wait for the `xpath` to appear in page. If at the moment of calling the\n   * method the `xpath` already exists, the method will return immediately. If\n   * the xpath doesn't appear after the `timeout` milliseconds of waiting, the\n   * function will throw.\n   *\n   * For a code example, see the example for {@link Frame.waitForSelector}. That\n   * function behaves identically other than taking a CSS selector rather than\n   * an XPath.\n   *\n   * @param xpath - the XPath expression to wait for.\n   * @param options  - options to configure the visiblity of the element and how\n   * long to wait before timing out.\n   */\n\n\n  async waitForXPath(xpath) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const handle = await this._secondaryWorld.waitForXPath(xpath, options);\n    if (!handle) return null;\n    const mainExecutionContext = await this._mainWorld.executionContext();\n    const result = await mainExecutionContext._adoptElementHandle(handle);\n    await handle.dispose();\n    return result;\n  }\n  /**\n   * @remarks\n   *\n   * @example\n   *\n   * The `waitForFunction` can be used to observe viewport size change:\n   * ```js\n   * const puppeteer = require('puppeteer');\n   *\n   * (async () => {\n   * .  const browser = await puppeteer.launch();\n   * .  const page = await browser.newPage();\n   * .  const watchDog = page.mainFrame().waitForFunction('window.innerWidth < 100');\n   * .  page.setViewport({width: 50, height: 50});\n   * .  await watchDog;\n   * .  await browser.close();\n   * })();\n   * ```\n   *\n   * To pass arguments from Node.js to the predicate of `page.waitForFunction` function:\n   *\n   * ```js\n   * const selector = '.foo';\n   * await frame.waitForFunction(\n   *   selector => !!document.querySelector(selector),\n   *   {}, // empty options object\n   *   selector\n   *);\n   * ```\n   *\n   * @param pageFunction - the function to evaluate in the frame context.\n   * @param options - options to configure the polling method and timeout.\n   * @param args - arguments to pass to the `pageFunction`.\n   * @returns the promise which resolve when the `pageFunction` returns a truthy value.\n   */\n\n\n  waitForFunction(pageFunction) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    for (var _len7 = arguments.length, args = new Array(_len7 > 2 ? _len7 - 2 : 0), _key7 = 2; _key7 < _len7; _key7++) {\n      args[_key7 - 2] = arguments[_key7];\n    }\n\n    return this._mainWorld.waitForFunction(pageFunction, options, ...args);\n  }\n  /**\n   * @returns the frame's title.\n   */\n\n\n  async title() {\n    return this._secondaryWorld.title();\n  }\n  /**\n   * @internal\n   */\n\n\n  _navigated(framePayload) {\n    this._name = framePayload.name;\n    this._url = `${framePayload.url}${framePayload.urlFragment || ''}`;\n  }\n  /**\n   * @internal\n   */\n\n\n  _navigatedWithinDocument(url) {\n    this._url = url;\n  }\n  /**\n   * @internal\n   */\n\n\n  _onLifecycleEvent(loaderId, name) {\n    if (name === 'init') {\n      this._loaderId = loaderId;\n\n      this._lifecycleEvents.clear();\n    }\n\n    this._lifecycleEvents.add(name);\n  }\n  /**\n   * @internal\n   */\n\n\n  _onLoadingStopped() {\n    this._lifecycleEvents.add('DOMContentLoaded');\n\n    this._lifecycleEvents.add('load');\n  }\n  /**\n   * @internal\n   */\n\n\n  _detach() {\n    this._detached = true;\n\n    this._mainWorld._detach();\n\n    this._secondaryWorld._detach();\n\n    if (this._parentFrame) this._parentFrame._childFrames.delete(this);\n    this._parentFrame = null;\n  }\n\n}\n\nexports.Frame = Frame;\n\nfunction assertNoLegacyNavigationOptions(options) {\n  (0, assert_js_1.assert)(options['networkIdleTimeout'] === undefined, 'ERROR: networkIdleTimeout option is no longer supported.');\n  (0, assert_js_1.assert)(options['networkIdleInflight'] === undefined, 'ERROR: networkIdleInflight option is no longer supported.');\n  (0, assert_js_1.assert)(options.waitUntil !== 'networkidle', 'ERROR: \"networkidle\" option is no longer supported. Use \"networkidle2\" instead');\n}","map":{"version":3,"mappings":"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","names":["UTILITY_WORLD_NAME","xPathPattern","exports","FrameAttached","Symbol","FrameNavigated","FrameDetached","FrameSwapped","LifecycleEvent","FrameNavigatedWithinDocument","ExecutionContextCreated","ExecutionContextDestroyed","FrameManager","EventEmitter_js_1","constructor","client","page","ignoreHTTPSErrors","timeoutSettings","Map","Set","_client","_page","_networkManager","NetworkManager_js_1","_timeoutSettings","setupEventListeners","session","on","event","_onFrameAttached","frameId","parentFrameId","_onFrameNavigated","frame","_onFrameNavigatedWithinDocument","url","_onFrameDetached","reason","_onFrameStoppedLoading","_onExecutionContextCreated","context","_onExecutionContextDestroyed","executionContextId","_onExecutionContextsCleared","_onLifecycleEvent","_onAttachedToTarget","_onDetachedFromTarget","initialize","result","Promise","all","send","frameTree","_handleFrameTree","enabled","then","_ensureIsolatedWorld","resolve","error","message","includes","networkManager","navigateFrame","options","assertNoLegacyNavigationOptions","referer","extraHTTPHeaders","waitUntil","timeout","navigationTimeout","watcher","LifecycleWatcher_js_1","ensureNewDocumentNavigation","race","navigate","_id","timeoutOrTerminationPromise","newDocumentNavigationPromise","sameDocumentNavigationPromise","dispose","navigationResponse","referrer","response","loaderId","errorText","Error","waitForFrameNavigation","targetInfo","type","_frames","get","targetId","Connection_js_1","fromSession","sessionId","_updateClient","isOOPFrame","_removeFramesRecursively","name","emit","_onLoadingStopped","parentId","id","childFrames","child","mainFrame","_mainFrame","frames","Array","from","values","has","parentFrame","Frame","set","framePayload","isMainFrame","delete","_navigated","key","_isolatedWorlds","add","source","ExecutionContext_js_1","worldName","filter","map","grantUniveralAccess","catch","helper_js_1","_navigatedWithinDocument","contextPayload","auxData","world","_mainWorld","_secondaryWorld","_hasContext","_setContext","_contextIdToContext","_world","entries","executionContextById","contextId","_detach","frameManager","_frameManager","_parentFrame","_url","_detached","_loaderId","_childFrames","DOMWorld_js_1","goto","waitForNavigation","executionContext","evaluateHandle","pageFunction","args","evaluate","$","selector","$x","expression","$eval","$$eval","$$","content","setContent","html","_name","isDetached","addScriptTag","addStyleTag","click","focus","hover","select","tap","text","waitFor","selectorOrFunctionOrTimeout","console","warn","isString","string","test","waitForXPath","waitForSelector","isNumber","fulfill","setTimeout","waitForFunction","reject","waitForTimeout","milliseconds","handle","mainExecutionContext","_adoptElementHandle","xpath","title","urlFragment","_lifecycleEvents","clear","undefined"],"sources":["../../../../src/common/FrameManager.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}