{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst os = __importStar(require(\"os\"));\n\nconst path = __importStar(require(\"path\"));\n\nconst fs = __importStar(require(\"fs\"));\n\nconst assert_js_1 = require(\"../common/assert.js\");\n\nconst BrowserFetcher_js_1 = require(\"./BrowserFetcher.js\");\n\nconst Browser_js_1 = require(\"../common/Browser.js\");\n\nconst BrowserRunner_js_1 = require(\"./BrowserRunner.js\");\n\nconst util_1 = require(\"util\");\n\nconst copyFileAsync = (0, util_1.promisify)(fs.copyFile);\nconst mkdtempAsync = (0, util_1.promisify)(fs.mkdtemp);\nconst writeFileAsync = (0, util_1.promisify)(fs.writeFile);\n\nconst tmpDir = () => process.env.PUPPETEER_TMP_DIR || os.tmpdir();\n/**\n * @internal\n */\n\n\nclass ChromeLauncher {\n  constructor(projectRoot, preferredRevision, isPuppeteerCore) {\n    this._projectRoot = projectRoot;\n    this._preferredRevision = preferredRevision;\n    this._isPuppeteerCore = isPuppeteerCore;\n  }\n\n  async launch() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    var _a;\n\n    const {\n      ignoreDefaultArgs = false,\n      args = [],\n      dumpio = false,\n      channel = null,\n      executablePath = null,\n      pipe = false,\n      env = process.env,\n      handleSIGINT = true,\n      handleSIGTERM = true,\n      handleSIGHUP = true,\n      ignoreHTTPSErrors = false,\n      defaultViewport = {\n        width: 800,\n        height: 600\n      },\n      slowMo = 0,\n      timeout = 30000,\n      waitForInitialPage = true,\n      debuggingPort = null\n    } = options;\n    const chromeArguments = [];\n    if (!ignoreDefaultArgs) chromeArguments.push(...this.defaultArgs(options));else if (Array.isArray(ignoreDefaultArgs)) chromeArguments.push(...this.defaultArgs(options).filter(arg => !ignoreDefaultArgs.includes(arg)));else chromeArguments.push(...args);\n\n    if (!chromeArguments.some(argument => argument.startsWith('--remote-debugging-'))) {\n      if (pipe) {\n        (0, assert_js_1.assert)(debuggingPort === null, 'Browser should be launched with either pipe or debugging port - not both.');\n        chromeArguments.push('--remote-debugging-pipe');\n      } else {\n        chromeArguments.push(`--remote-debugging-port=${debuggingPort || 0}`);\n      }\n    }\n\n    let userDataDir;\n    let isTempUserDataDir = true; // Check for the user data dir argument, which will always be set even\n    // with a custom directory specified via the userDataDir option.\n\n    const userDataDirIndex = chromeArguments.findIndex(arg => {\n      return arg.startsWith('--user-data-dir');\n    });\n\n    if (userDataDirIndex !== -1) {\n      userDataDir = chromeArguments[userDataDirIndex].split('=')[1];\n      isTempUserDataDir = false;\n    } else {\n      userDataDir = await mkdtempAsync(path.join(tmpDir(), 'puppeteer_dev_chrome_profile-'));\n      chromeArguments.push(`--user-data-dir=${userDataDir}`);\n    }\n\n    let chromeExecutable = executablePath;\n\n    if (channel) {\n      // executablePath is detected by channel, so it should not be specified by user.\n      (0, assert_js_1.assert)(!executablePath, '`executablePath` must not be specified when `channel` is given.');\n      chromeExecutable = executablePathForChannel(channel);\n    } else if (!executablePath) {\n      const {\n        missingText,\n        executablePath\n      } = resolveExecutablePath(this);\n      if (missingText) throw new Error(missingText);\n      chromeExecutable = executablePath;\n    }\n\n    if (!chromeExecutable) {\n      throw new Error('chromeExecutable is not found.');\n    }\n\n    const usePipe = chromeArguments.includes('--remote-debugging-pipe');\n    const runner = new BrowserRunner_js_1.BrowserRunner(this.product, chromeExecutable, chromeArguments, userDataDir, isTempUserDataDir);\n    runner.start({\n      handleSIGHUP,\n      handleSIGTERM,\n      handleSIGINT,\n      dumpio,\n      env,\n      pipe: usePipe\n    });\n    let browser;\n\n    try {\n      const connection = await runner.setupConnection({\n        usePipe,\n        timeout,\n        slowMo,\n        preferredRevision: this._preferredRevision\n      });\n      browser = await Browser_js_1.Browser.create(connection, [], ignoreHTTPSErrors, defaultViewport, (_a = runner.proc) !== null && _a !== void 0 ? _a : undefined, runner.close.bind(runner));\n    } catch (error) {\n      runner.kill();\n      throw error;\n    }\n\n    if (waitForInitialPage) {\n      try {\n        await browser.waitForTarget(t => t.type() === 'page', {\n          timeout\n        });\n      } catch (error) {\n        await browser.close();\n        throw error;\n      }\n    }\n\n    return browser;\n  }\n\n  defaultArgs() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const chromeArguments = ['--disable-background-networking', '--enable-features=NetworkService,NetworkServiceInProcess', '--disable-background-timer-throttling', '--disable-backgrounding-occluded-windows', '--disable-breakpad', '--disable-client-side-phishing-detection', '--disable-component-extensions-with-background-pages', '--disable-default-apps', '--disable-dev-shm-usage', '--disable-extensions', '--disable-features=Translate,BackForwardCache', '--disable-hang-monitor', '--disable-ipc-flooding-protection', '--disable-popup-blocking', '--disable-prompt-on-repost', '--disable-renderer-backgrounding', '--disable-sync', '--force-color-profile=srgb', '--metrics-recording-only', '--no-first-run', '--enable-automation', '--password-store=basic', '--use-mock-keychain', // TODO(sadym): remove '--enable-blink-features=IdleDetection'\n    // once IdleDetection is turned on by default.\n    '--enable-blink-features=IdleDetection', '--export-tagged-pdf'];\n    const {\n      devtools = false,\n      headless = !devtools,\n      args = [],\n      userDataDir = null\n    } = options;\n    if (userDataDir) chromeArguments.push(`--user-data-dir=${path.resolve(userDataDir)}`);\n    if (devtools) chromeArguments.push('--auto-open-devtools-for-tabs');\n\n    if (headless) {\n      chromeArguments.push(headless === 'chrome' ? '--headless=chrome' : '--headless', '--hide-scrollbars', '--mute-audio');\n    }\n\n    if (args.every(arg => arg.startsWith('-'))) chromeArguments.push('about:blank');\n    chromeArguments.push(...args);\n    return chromeArguments;\n  }\n\n  executablePath(channel) {\n    if (channel) {\n      return executablePathForChannel(channel);\n    } else {\n      return resolveExecutablePath(this).executablePath;\n    }\n  }\n\n  get product() {\n    return 'chrome';\n  }\n\n}\n/**\n * @internal\n */\n\n\nclass FirefoxLauncher {\n  constructor(projectRoot, preferredRevision, isPuppeteerCore) {\n    this._projectRoot = projectRoot;\n    this._preferredRevision = preferredRevision;\n    this._isPuppeteerCore = isPuppeteerCore;\n  }\n\n  async launch() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      ignoreDefaultArgs = false,\n      args = [],\n      dumpio = false,\n      executablePath = null,\n      pipe = false,\n      env = process.env,\n      handleSIGINT = true,\n      handleSIGTERM = true,\n      handleSIGHUP = true,\n      ignoreHTTPSErrors = false,\n      defaultViewport = {\n        width: 800,\n        height: 600\n      },\n      slowMo = 0,\n      timeout = 30000,\n      extraPrefsFirefox = {},\n      waitForInitialPage = true,\n      debuggingPort = null\n    } = options;\n    const firefoxArguments = [];\n    if (!ignoreDefaultArgs) firefoxArguments.push(...this.defaultArgs(options));else if (Array.isArray(ignoreDefaultArgs)) firefoxArguments.push(...this.defaultArgs(options).filter(arg => !ignoreDefaultArgs.includes(arg)));else firefoxArguments.push(...args);\n\n    if (!firefoxArguments.some(argument => argument.startsWith('--remote-debugging-'))) {\n      if (pipe) {\n        (0, assert_js_1.assert)(debuggingPort === null, 'Browser should be launched with either pipe or debugging port - not both.');\n      }\n\n      firefoxArguments.push(`--remote-debugging-port=${debuggingPort || 0}`);\n    }\n\n    let userDataDir = null;\n    let isTempUserDataDir = true; // Check for the profile argument, which will always be set even\n    // with a custom directory specified via the userDataDir option.\n\n    const profileArgIndex = firefoxArguments.findIndex(arg => {\n      return ['-profile', '--profile'].includes(arg);\n    });\n\n    if (profileArgIndex !== -1) {\n      userDataDir = firefoxArguments[profileArgIndex + 1];\n\n      if (!fs.existsSync(userDataDir)) {\n        throw new Error(`Firefox profile not found at '${userDataDir}'`);\n      } // When using a custom Firefox profile it needs to be populated\n      // with required preferences.\n\n\n      isTempUserDataDir = false;\n      const prefs = this.defaultPreferences(extraPrefsFirefox);\n      this.writePreferences(prefs, userDataDir);\n    } else {\n      userDataDir = await this._createProfile(extraPrefsFirefox);\n      firefoxArguments.push('--profile');\n      firefoxArguments.push(userDataDir);\n    }\n\n    await this._updateRevision();\n    let firefoxExecutable = executablePath;\n\n    if (!executablePath) {\n      const {\n        missingText,\n        executablePath\n      } = resolveExecutablePath(this);\n      if (missingText) throw new Error(missingText);\n      firefoxExecutable = executablePath;\n    }\n\n    if (!firefoxExecutable) {\n      throw new Error('firefoxExecutable is not found.');\n    }\n\n    const runner = new BrowserRunner_js_1.BrowserRunner(this.product, firefoxExecutable, firefoxArguments, userDataDir, isTempUserDataDir);\n    runner.start({\n      handleSIGHUP,\n      handleSIGTERM,\n      handleSIGINT,\n      dumpio,\n      env,\n      pipe\n    });\n    let browser;\n\n    try {\n      const connection = await runner.setupConnection({\n        usePipe: pipe,\n        timeout,\n        slowMo,\n        preferredRevision: this._preferredRevision\n      });\n      browser = await Browser_js_1.Browser.create(connection, [], ignoreHTTPSErrors, defaultViewport, runner.proc, runner.close.bind(runner));\n    } catch (error) {\n      runner.kill();\n      throw error;\n    }\n\n    if (waitForInitialPage) {\n      try {\n        await browser.waitForTarget(t => t.type() === 'page', {\n          timeout\n        });\n      } catch (error) {\n        await browser.close();\n        throw error;\n      }\n    }\n\n    return browser;\n  }\n\n  executablePath() {\n    return resolveExecutablePath(this).executablePath;\n  }\n\n  async _updateRevision() {\n    // replace 'latest' placeholder with actual downloaded revision\n    if (this._preferredRevision === 'latest') {\n      if (!this._projectRoot) {\n        throw new Error('_projectRoot is undefined. Unable to create a BrowserFetcher.');\n      }\n\n      const browserFetcher = new BrowserFetcher_js_1.BrowserFetcher(this._projectRoot, {\n        product: this.product\n      });\n      const localRevisions = await browserFetcher.localRevisions();\n      if (localRevisions[0]) this._preferredRevision = localRevisions[0];\n    }\n  }\n\n  get product() {\n    return 'firefox';\n  }\n\n  defaultArgs() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      devtools = false,\n      headless = !devtools,\n      args = [],\n      userDataDir = null\n    } = options;\n    const firefoxArguments = ['--no-remote'];\n    if (os.platform() === 'darwin') firefoxArguments.push('--foreground');else if (os.platform().startsWith('win')) {\n      firefoxArguments.push('--wait-for-browser');\n    }\n\n    if (userDataDir) {\n      firefoxArguments.push('--profile');\n      firefoxArguments.push(userDataDir);\n    }\n\n    if (headless) firefoxArguments.push('--headless');\n    if (devtools) firefoxArguments.push('--devtools');\n    if (args.every(arg => arg.startsWith('-'))) firefoxArguments.push('about:blank');\n    firefoxArguments.push(...args);\n    return firefoxArguments;\n  }\n\n  defaultPreferences(extraPrefs) {\n    const server = 'dummy.test';\n    const defaultPrefs = {\n      // Make sure Shield doesn't hit the network.\n      'app.normandy.api_url': '',\n      // Disable Firefox old build background check\n      'app.update.checkInstallTime': false,\n      // Disable automatically upgrading Firefox\n      'app.update.disabledForTesting': true,\n      // Increase the APZ content response timeout to 1 minute\n      'apz.content_response_timeout': 60000,\n      // Prevent various error message on the console\n      // jest-puppeteer asserts that no error message is emitted by the console\n      'browser.contentblocking.features.standard': '-tp,tpPrivate,cookieBehavior0,-cm,-fp',\n      // Enable the dump function: which sends messages to the system\n      // console\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=1543115\n      'browser.dom.window.dump.enabled': true,\n      // Disable topstories\n      'browser.newtabpage.activity-stream.feeds.system.topstories': false,\n      // Always display a blank page\n      'browser.newtabpage.enabled': false,\n      // Background thumbnails in particular cause grief: and disabling\n      // thumbnails in general cannot hurt\n      'browser.pagethumbnails.capturing_disabled': true,\n      // Disable safebrowsing components.\n      'browser.safebrowsing.blockedURIs.enabled': false,\n      'browser.safebrowsing.downloads.enabled': false,\n      'browser.safebrowsing.malware.enabled': false,\n      'browser.safebrowsing.passwords.enabled': false,\n      'browser.safebrowsing.phishing.enabled': false,\n      // Disable updates to search engines.\n      'browser.search.update': false,\n      // Do not restore the last open set of tabs if the browser has crashed\n      'browser.sessionstore.resume_from_crash': false,\n      // Skip check for default browser on startup\n      'browser.shell.checkDefaultBrowser': false,\n      // Disable newtabpage\n      'browser.startup.homepage': 'about:blank',\n      // Do not redirect user when a milstone upgrade of Firefox is detected\n      'browser.startup.homepage_override.mstone': 'ignore',\n      // Start with a blank page about:blank\n      'browser.startup.page': 0,\n      // Do not allow background tabs to be zombified on Android: otherwise for\n      // tests that open additional tabs: the test harness tab itself might get\n      // unloaded\n      'browser.tabs.disableBackgroundZombification': false,\n      // Do not warn when closing all other open tabs\n      'browser.tabs.warnOnCloseOtherTabs': false,\n      // Do not warn when multiple tabs will be opened\n      'browser.tabs.warnOnOpen': false,\n      // Disable the UI tour.\n      'browser.uitour.enabled': false,\n      // Turn off search suggestions in the location bar so as not to trigger\n      // network connections.\n      'browser.urlbar.suggest.searches': false,\n      // Disable first run splash page on Windows 10\n      'browser.usedOnWindows10.introURL': '',\n      // Do not warn on quitting Firefox\n      'browser.warnOnQuit': false,\n      // Defensively disable data reporting systems\n      'datareporting.healthreport.documentServerURI': `http://${server}/dummy/healthreport/`,\n      'datareporting.healthreport.logging.consoleEnabled': false,\n      'datareporting.healthreport.service.enabled': false,\n      'datareporting.healthreport.service.firstRun': false,\n      'datareporting.healthreport.uploadEnabled': false,\n      // Do not show datareporting policy notifications which can interfere with tests\n      'datareporting.policy.dataSubmissionEnabled': false,\n      'datareporting.policy.dataSubmissionPolicyBypassNotification': true,\n      // DevTools JSONViewer sometimes fails to load dependencies with its require.js.\n      // This doesn't affect Puppeteer but spams console (Bug 1424372)\n      'devtools.jsonview.enabled': false,\n      // Disable popup-blocker\n      'dom.disable_open_during_load': false,\n      // Enable the support for File object creation in the content process\n      // Required for |Page.setFileInputFiles| protocol method.\n      'dom.file.createInChild': true,\n      // Disable the ProcessHangMonitor\n      'dom.ipc.reportProcessHangs': false,\n      // Disable slow script dialogues\n      'dom.max_chrome_script_run_time': 0,\n      'dom.max_script_run_time': 0,\n      // Only load extensions from the application and user profile\n      // AddonManager.SCOPE_PROFILE + AddonManager.SCOPE_APPLICATION\n      'extensions.autoDisableScopes': 0,\n      'extensions.enabledScopes': 5,\n      // Disable metadata caching for installed add-ons by default\n      'extensions.getAddons.cache.enabled': false,\n      // Disable installing any distribution extensions or add-ons.\n      'extensions.installDistroAddons': false,\n      // Disabled screenshots extension\n      'extensions.screenshots.disabled': true,\n      // Turn off extension updates so they do not bother tests\n      'extensions.update.enabled': false,\n      // Turn off extension updates so they do not bother tests\n      'extensions.update.notifyUser': false,\n      // Make sure opening about:addons will not hit the network\n      'extensions.webservice.discoverURL': `http://${server}/dummy/discoveryURL`,\n      // Temporarily force disable BFCache in parent (https://bit.ly/bug-1732263)\n      'fission.bfcacheInParent': false,\n      // Force all web content to use a single content process\n      'fission.webContentIsolationStrategy': 0,\n      // Allow the application to have focus even it runs in the background\n      'focusmanager.testmode': true,\n      // Disable useragent updates\n      'general.useragent.updates.enabled': false,\n      // Always use network provider for geolocation tests so we bypass the\n      // macOS dialog raised by the corelocation provider\n      'geo.provider.testing': true,\n      // Do not scan Wifi\n      'geo.wifi.scan': false,\n      // No hang monitor\n      'hangmonitor.timeout': 0,\n      // Show chrome errors and warnings in the error console\n      'javascript.options.showInConsole': true,\n      // Disable download and usage of OpenH264: and Widevine plugins\n      'media.gmp-manager.updateEnabled': false,\n      // Prevent various error message on the console\n      // jest-puppeteer asserts that no error message is emitted by the console\n      'network.cookie.cookieBehavior': 0,\n      // Disable experimental feature that is only available in Nightly\n      'network.cookie.sameSite.laxByDefault': false,\n      // Do not prompt for temporary redirects\n      'network.http.prompt-temp-redirect': false,\n      // Disable speculative connections so they are not reported as leaking\n      // when they are hanging around\n      'network.http.speculative-parallel-limit': 0,\n      // Do not automatically switch between offline and online\n      'network.manage-offline-status': false,\n      // Make sure SNTP requests do not hit the network\n      'network.sntp.pools': server,\n      // Disable Flash.\n      'plugin.state.flash': 0,\n      'privacy.trackingprotection.enabled': false,\n      // Can be removed once Firefox 89 is no longer supported\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=1710839\n      'remote.enabled': true,\n      // Don't do network connections for mitm priming\n      'security.certerrors.mitm.priming.enabled': false,\n      // Local documents have access to all other local documents,\n      // including directory listings\n      'security.fileuri.strict_origin_policy': false,\n      // Do not wait for the notification button security delay\n      'security.notification_enable_delay': 0,\n      // Ensure blocklist updates do not hit the network\n      'services.settings.server': `http://${server}/dummy/blocklist/`,\n      // Do not automatically fill sign-in forms with known usernames and\n      // passwords\n      'signon.autofillForms': false,\n      // Disable password capture, so that tests that include forms are not\n      // influenced by the presence of the persistent doorhanger notification\n      'signon.rememberSignons': false,\n      // Disable first-run welcome page\n      'startup.homepage_welcome_url': 'about:blank',\n      // Disable first-run welcome page\n      'startup.homepage_welcome_url.additional': '',\n      // Disable browser animations (tabs, fullscreen, sliding alerts)\n      'toolkit.cosmeticAnimations.enabled': false,\n      // Prevent starting into safe mode after application crashes\n      'toolkit.startup.max_resumed_crashes': -1\n    };\n    return Object.assign(defaultPrefs, extraPrefs);\n  }\n  /**\n   * Populates the user.js file with custom preferences as needed to allow\n   * Firefox's CDP support to properly function. These preferences will be\n   * automatically copied over to prefs.js during startup of Firefox. To be\n   * able to restore the original values of preferences a backup of prefs.js\n   * will be created.\n   *\n   * @param prefs List of preferences to add.\n   * @param profilePath Firefox profile to write the preferences to.\n   */\n\n\n  async writePreferences(prefs, profilePath) {\n    const lines = Object.entries(prefs).map(_ref => {\n      let [key, value] = _ref;\n      return `user_pref(${JSON.stringify(key)}, ${JSON.stringify(value)});`;\n    });\n    await writeFileAsync(path.join(profilePath, 'user.js'), lines.join('\\n')); // Create a backup of the preferences file if it already exitsts.\n\n    const prefsPath = path.join(profilePath, 'prefs.js');\n\n    if (fs.existsSync(prefsPath)) {\n      const prefsBackupPath = path.join(profilePath, 'prefs.js.puppeteer');\n      await copyFileAsync(prefsPath, prefsBackupPath);\n    }\n  }\n\n  async _createProfile(extraPrefs) {\n    const temporaryProfilePath = await mkdtempAsync(path.join(tmpDir(), 'puppeteer_dev_firefox_profile-'));\n    const prefs = this.defaultPreferences(extraPrefs);\n    await this.writePreferences(prefs, temporaryProfilePath);\n    return temporaryProfilePath;\n  }\n\n}\n\nfunction executablePathForChannel(channel) {\n  const platform = os.platform();\n  let chromePath;\n\n  switch (platform) {\n    case 'win32':\n      switch (channel) {\n        case 'chrome':\n          chromePath = `${process.env.PROGRAMFILES}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`;\n          break;\n\n        case 'chrome-beta':\n          chromePath = `${process.env.PROGRAMFILES}\\\\Google\\\\Chrome Beta\\\\Application\\\\chrome.exe`;\n          break;\n\n        case 'chrome-canary':\n          chromePath = `${process.env.PROGRAMFILES}\\\\Google\\\\Chrome SxS\\\\Application\\\\chrome.exe`;\n          break;\n\n        case 'chrome-dev':\n          chromePath = `${process.env.PROGRAMFILES}\\\\Google\\\\Chrome Dev\\\\Application\\\\chrome.exe`;\n          break;\n      }\n\n      break;\n\n    case 'darwin':\n      switch (channel) {\n        case 'chrome':\n          chromePath = '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome';\n          break;\n\n        case 'chrome-beta':\n          chromePath = '/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta';\n          break;\n\n        case 'chrome-canary':\n          chromePath = '/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary';\n          break;\n\n        case 'chrome-dev':\n          chromePath = '/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev';\n          break;\n      }\n\n      break;\n\n    case 'linux':\n      switch (channel) {\n        case 'chrome':\n          chromePath = '/opt/google/chrome/chrome';\n          break;\n\n        case 'chrome-beta':\n          chromePath = '/opt/google/chrome-beta/chrome';\n          break;\n\n        case 'chrome-dev':\n          chromePath = '/opt/google/chrome-unstable/chrome';\n          break;\n      }\n\n      break;\n  }\n\n  if (!chromePath) {\n    throw new Error(`Unable to detect browser executable path for '${channel}' on ${platform}.`);\n  } // Check if Chrome exists and is accessible.\n\n\n  try {\n    fs.accessSync(chromePath);\n  } catch (error) {\n    throw new Error(`Could not find Google Chrome executable for channel '${channel}' at '${chromePath}'.`);\n  }\n\n  return chromePath;\n}\n\nfunction resolveExecutablePath(launcher) {\n  const {\n    product,\n    _isPuppeteerCore,\n    _projectRoot,\n    _preferredRevision\n  } = launcher;\n  let downloadPath; // puppeteer-core doesn't take into account PUPPETEER_* env variables.\n\n  if (!_isPuppeteerCore) {\n    const executablePath = process.env.PUPPETEER_EXECUTABLE_PATH || process.env.npm_config_puppeteer_executable_path || process.env.npm_package_config_puppeteer_executable_path;\n\n    if (executablePath) {\n      const missingText = !fs.existsSync(executablePath) ? 'Tried to use PUPPETEER_EXECUTABLE_PATH env variable to launch browser but did not find any executable at: ' + executablePath : undefined;\n      return {\n        executablePath,\n        missingText\n      };\n    }\n\n    const ubuntuChromiumPath = '/usr/bin/chromium-browser';\n\n    if (product === 'chrome' && os.platform() !== 'darwin' && os.arch() === 'arm64' && fs.existsSync(ubuntuChromiumPath)) {\n      return {\n        executablePath: ubuntuChromiumPath,\n        missingText: undefined\n      };\n    }\n\n    downloadPath = process.env.PUPPETEER_DOWNLOAD_PATH || process.env.npm_config_puppeteer_download_path || process.env.npm_package_config_puppeteer_download_path;\n  }\n\n  if (!_projectRoot) {\n    throw new Error('_projectRoot is undefined. Unable to create a BrowserFetcher.');\n  }\n\n  const browserFetcher = new BrowserFetcher_js_1.BrowserFetcher(_projectRoot, {\n    product: product,\n    path: downloadPath\n  });\n\n  if (!_isPuppeteerCore && product === 'chrome') {\n    const revision = process.env['PUPPETEER_CHROMIUM_REVISION'];\n\n    if (revision) {\n      const revisionInfo = browserFetcher.revisionInfo(revision);\n      const missingText = !revisionInfo.local ? 'Tried to use PUPPETEER_CHROMIUM_REVISION env variable to launch browser but did not find executable at: ' + revisionInfo.executablePath : undefined;\n      return {\n        executablePath: revisionInfo.executablePath,\n        missingText\n      };\n    }\n  }\n\n  const revisionInfo = browserFetcher.revisionInfo(_preferredRevision);\n  const firefoxHelp = `Run \\`PUPPETEER_PRODUCT=firefox npm install\\` to download a supported Firefox browser binary.`;\n  const chromeHelp = `Run \\`npm install\\` to download the correct Chromium revision (${launcher._preferredRevision}).`;\n  const missingText = !revisionInfo.local ? `Could not find expected browser (${product}) locally. ${product === 'chrome' ? chromeHelp : firefoxHelp}` : undefined;\n  return {\n    executablePath: revisionInfo.executablePath,\n    missingText\n  };\n}\n/**\n * @internal\n */\n\n\nfunction Launcher(projectRoot, preferredRevision, isPuppeteerCore, product) {\n  // puppeteer-core doesn't take into account PUPPETEER_* env variables.\n  if (!product && !isPuppeteerCore) product = process.env.PUPPETEER_PRODUCT || process.env.npm_config_puppeteer_product || process.env.npm_package_config_puppeteer_product;\n\n  switch (product) {\n    case 'firefox':\n      return new FirefoxLauncher(projectRoot, preferredRevision, isPuppeteerCore);\n\n    case 'chrome':\n    default:\n      if (typeof product !== 'undefined' && product !== 'chrome') {\n        /* The user gave us an incorrect product name\n         * we'll default to launching Chrome, but log to the console\n         * to let the user know (they've probably typoed).\n         */\n        console.warn(`Warning: unknown product name ${product}. Falling back to chrome.`);\n      }\n\n      return new ChromeLauncher(projectRoot, preferredRevision, isPuppeteerCore);\n  }\n}\n\nexports.default = Launcher;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;AAeA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AAEA,MAAMA,aAAa,GAAG,sBAAUC,EAAE,CAACC,QAAb,CAAtB;AACA,MAAMC,YAAY,GAAG,sBAAUF,EAAE,CAACG,OAAb,CAArB;AACA,MAAMC,cAAc,GAAG,sBAAUJ,EAAE,CAACK,SAAb,CAAvB;;AAUA,MAAMC,MAAM,GAAG,MAAMC,OAAO,CAACC,GAAR,CAAYC,iBAAZ,IAAiCC,EAAE,CAACC,MAAH,EAAtD;AAaA;;;;;AAGA,MAAMC,cAAN,CAAoB;EAKlBC,YACEC,WADF,EAEEC,iBAFF,EAGEC,eAHF,EAG0B;IAExB,KAAKC,YAAL,GAAoBH,WAApB;IACA,KAAKI,kBAAL,GAA0BH,iBAA1B;IACA,KAAKI,gBAAL,GAAwBH,eAAxB;EACD;;EAEW,MAANI,MAAM,GAAyC;IAAA,IAAxCC,OAAwC,uEAAF,EAAE;;;;IACnD,MAAM;MACJC,iBAAiB,GAAG,KADhB;MAEJC,IAAI,GAAG,EAFH;MAGJC,MAAM,GAAG,KAHL;MAIJC,OAAO,GAAG,IAJN;MAKJC,cAAc,GAAG,IALb;MAMJC,IAAI,GAAG,KANH;MAOJnB,GAAG,GAAGD,OAAO,CAACC,GAPV;MAQJoB,YAAY,GAAG,IARX;MASJC,aAAa,GAAG,IATZ;MAUJC,YAAY,GAAG,IAVX;MAWJC,iBAAiB,GAAG,KAXhB;MAYJC,eAAe,GAAG;QAAEC,KAAK,EAAE,GAAT;QAAcC,MAAM,EAAE;MAAtB,CAZd;MAaJC,MAAM,GAAG,CAbL;MAcJC,OAAO,GAAG,KAdN;MAeJC,kBAAkB,GAAG,IAfjB;MAgBJC,aAAa,GAAG;IAhBZ,IAiBFjB,OAjBJ;IAmBA,MAAMkB,eAAe,GAAG,EAAxB;IACA,IAAI,CAACjB,iBAAL,EAAwBiB,eAAe,CAACC,IAAhB,CAAqB,GAAG,KAAKC,WAAL,CAAiBpB,OAAjB,CAAxB,EAAxB,KACK,IAAIqB,KAAK,CAACC,OAAN,CAAcrB,iBAAd,CAAJ,EACHiB,eAAe,CAACC,IAAhB,CACE,GAAG,KAAKC,WAAL,CAAiBpB,OAAjB,EAA0BuB,MAA1B,CACAC,GAAD,IAAS,CAACvB,iBAAiB,CAACwB,QAAlB,CAA2BD,GAA3B,CADT,CADL,EADG,KAMAN,eAAe,CAACC,IAAhB,CAAqB,GAAGjB,IAAxB;;IAEL,IACE,CAACgB,eAAe,CAACQ,IAAhB,CAAsBC,QAAD,IACpBA,QAAQ,CAACC,UAAT,CAAoB,qBAApB,CADD,CADH,EAIE;MACA,IAAItB,IAAJ,EAAU;QACR,wBACEW,aAAa,KAAK,IADpB,EAEE,2EAFF;QAIAC,eAAe,CAACC,IAAhB,CAAqB,yBAArB;MACD,CAND,MAMO;QACLD,eAAe,CAACC,IAAhB,CAAqB,2BAA2BF,aAAa,IAAI,CAAC,EAAlE;MACD;IACF;;IAED,IAAIY,WAAJ;IACA,IAAIC,iBAAiB,GAAG,IAAxB,CA/CmD,CAiDnD;IACA;;IACA,MAAMC,gBAAgB,GAAGb,eAAe,CAACc,SAAhB,CAA2BR,GAAD,IAAQ;MACzD,OAAOA,GAAG,CAACI,UAAJ,CAAe,iBAAf,CAAP;IACD,CAFwB,CAAzB;;IAIA,IAAIG,gBAAgB,KAAK,CAAC,CAA1B,EAA6B;MAC3BF,WAAW,GAAGX,eAAe,CAACa,gBAAD,CAAf,CAAkCE,KAAlC,CAAwC,GAAxC,EAA6C,CAA7C,CAAd;MACAH,iBAAiB,GAAG,KAApB;IACD,CAHD,MAGO;MACLD,WAAW,GAAG,MAAMhD,YAAY,CAC9BqD,IAAI,CAACC,IAAL,CAAUlD,MAAM,EAAhB,EAAoB,+BAApB,CAD8B,CAAhC;MAGAiC,eAAe,CAACC,IAAhB,CAAqB,mBAAmBU,WAAW,EAAnD;IACD;;IAED,IAAIO,gBAAgB,GAAG/B,cAAvB;;IAEA,IAAID,OAAJ,EAAa;MACX;MACA,wBACE,CAACC,cADH,EAEE,iEAFF;MAKA+B,gBAAgB,GAAGC,wBAAwB,CAACjC,OAAD,CAA3C;IACD,CARD,MAQO,IAAI,CAACC,cAAL,EAAqB;MAC1B,MAAM;QAAEiC,WAAF;QAAejC;MAAf,IAAkCkC,qBAAqB,CAAC,IAAD,CAA7D;MACA,IAAID,WAAJ,EAAiB,MAAM,IAAIE,KAAJ,CAAUF,WAAV,CAAN;MACjBF,gBAAgB,GAAG/B,cAAnB;IACD;;IAED,IAAI,CAAC+B,gBAAL,EAAuB;MACrB,MAAM,IAAII,KAAJ,CAAU,gCAAV,CAAN;IACD;;IAED,MAAMC,OAAO,GAAGvB,eAAe,CAACO,QAAhB,CAAyB,yBAAzB,CAAhB;IACA,MAAMiB,MAAM,GAAG,IAAIC,gCAAJ,CACb,KAAKC,OADQ,EAEbR,gBAFa,EAGblB,eAHa,EAIbW,WAJa,EAKbC,iBALa,CAAf;IAOAY,MAAM,CAACG,KAAP,CAAa;MACXpC,YADW;MAEXD,aAFW;MAGXD,YAHW;MAIXJ,MAJW;MAKXhB,GALW;MAMXmB,IAAI,EAAEmC;IANK,CAAb;IASA,IAAIK,OAAJ;;IACA,IAAI;MACF,MAAMC,UAAU,GAAG,MAAML,MAAM,CAACM,eAAP,CAAuB;QAC9CP,OAD8C;QAE9C1B,OAF8C;QAG9CD,MAH8C;QAI9CpB,iBAAiB,EAAE,KAAKG;MAJsB,CAAvB,CAAzB;MAMAiD,OAAO,GAAG,MAAMG,qBAAQC,MAAR,CACdH,UADc,EAEd,EAFc,EAGdrC,iBAHc,EAIdC,eAJc,EAKd,YAAM,CAACwC,IAAP,MAAW,IAAX,IAAWC,aAAX,GAAWA,EAAX,GAAeC,SALD,EAMdX,MAAM,CAACY,KAAP,CAAaC,IAAb,CAAkBb,MAAlB,CANc,CAAhB;IAQD,CAfD,CAeE,OAAOc,KAAP,EAAc;MACdd,MAAM,CAACe,IAAP;MACA,MAAMD,KAAN;IACD;;IAED,IAAIxC,kBAAJ,EAAwB;MACtB,IAAI;QACF,MAAM8B,OAAO,CAACY,aAAR,CAAuBC,CAAD,IAAOA,CAAC,CAACC,IAAF,OAAa,MAA1C,EAAkD;UAAE7C;QAAF,CAAlD,CAAN;MACD,CAFD,CAEE,OAAOyC,KAAP,EAAc;QACd,MAAMV,OAAO,CAACQ,KAAR,EAAN;QACA,MAAME,KAAN;MACD;IACF;;IAED,OAAOV,OAAP;EACD;;EAED1B,WAAW,GAA2C;IAAA,IAA1CpB,OAA0C,uEAAF,EAAE;IACpD,MAAMkB,eAAe,GAAG,CACtB,iCADsB,EAEtB,0DAFsB,EAGtB,uCAHsB,EAItB,0CAJsB,EAKtB,oBALsB,EAMtB,0CANsB,EAOtB,sDAPsB,EAQtB,wBARsB,EAStB,yBATsB,EAUtB,sBAVsB,EAWtB,+CAXsB,EAYtB,wBAZsB,EAatB,mCAbsB,EActB,0BAdsB,EAetB,4BAfsB,EAgBtB,kCAhBsB,EAiBtB,gBAjBsB,EAkBtB,4BAlBsB,EAmBtB,0BAnBsB,EAoBtB,gBApBsB,EAqBtB,qBArBsB,EAsBtB,wBAtBsB,EAuBtB,qBAvBsB,EAwBtB;IACA;IACA,uCA1BsB,EA2BtB,qBA3BsB,CAAxB;IA6BA,MAAM;MACJ2C,QAAQ,GAAG,KADP;MAEJC,QAAQ,GAAG,CAACD,QAFR;MAGJ3D,IAAI,GAAG,EAHH;MAIJ2B,WAAW,GAAG;IAJV,IAKF7B,OALJ;IAMA,IAAI6B,WAAJ,EACEX,eAAe,CAACC,IAAhB,CAAqB,mBAAmBe,IAAI,CAAC6B,OAAL,CAAalC,WAAb,CAAyB,EAAjE;IACF,IAAIgC,QAAJ,EAAc3C,eAAe,CAACC,IAAhB,CAAqB,+BAArB;;IACd,IAAI2C,QAAJ,EAAc;MACZ5C,eAAe,CAACC,IAAhB,CACE2C,QAAQ,KAAK,QAAb,GAAwB,mBAAxB,GAA8C,YADhD,EAEE,mBAFF,EAGE,cAHF;IAKD;;IACD,IAAI5D,IAAI,CAAC8D,KAAL,CAAYxC,GAAD,IAASA,GAAG,CAACI,UAAJ,CAAe,GAAf,CAApB,CAAJ,EACEV,eAAe,CAACC,IAAhB,CAAqB,aAArB;IACFD,eAAe,CAACC,IAAhB,CAAqB,GAAGjB,IAAxB;IACA,OAAOgB,eAAP;EACD;;EAEDb,cAAc,CAACD,OAAD,EAA+B;IAC3C,IAAIA,OAAJ,EAAa;MACX,OAAOiC,wBAAwB,CAACjC,OAAD,CAA/B;IACD,CAFD,MAEO;MACL,OAAOmC,qBAAqB,CAAC,IAAD,CAArB,CAA4BlC,cAAnC;IACD;EACF;;EAEU,IAAPuC,OAAO;IACT,OAAO,QAAP;EACD;;AApNiB;AAuNpB;;;;;AAGA,MAAMqB,eAAN,CAAqB;EAKnBzE,YACEC,WADF,EAEEC,iBAFF,EAGEC,eAHF,EAG0B;IAExB,KAAKC,YAAL,GAAoBH,WAApB;IACA,KAAKI,kBAAL,GAA0BH,iBAA1B;IACA,KAAKI,gBAAL,GAAwBH,eAAxB;EACD;;EAEW,MAANI,MAAM,GAAyC;IAAA,IAAxCC,OAAwC,uEAAF,EAAE;IACnD,MAAM;MACJC,iBAAiB,GAAG,KADhB;MAEJC,IAAI,GAAG,EAFH;MAGJC,MAAM,GAAG,KAHL;MAIJE,cAAc,GAAG,IAJb;MAKJC,IAAI,GAAG,KALH;MAMJnB,GAAG,GAAGD,OAAO,CAACC,GANV;MAOJoB,YAAY,GAAG,IAPX;MAQJC,aAAa,GAAG,IARZ;MASJC,YAAY,GAAG,IATX;MAUJC,iBAAiB,GAAG,KAVhB;MAWJC,eAAe,GAAG;QAAEC,KAAK,EAAE,GAAT;QAAcC,MAAM,EAAE;MAAtB,CAXd;MAYJC,MAAM,GAAG,CAZL;MAaJC,OAAO,GAAG,KAbN;MAcJmD,iBAAiB,GAAG,EAdhB;MAeJlD,kBAAkB,GAAG,IAfjB;MAgBJC,aAAa,GAAG;IAhBZ,IAiBFjB,OAjBJ;IAmBA,MAAMmE,gBAAgB,GAAG,EAAzB;IACA,IAAI,CAAClE,iBAAL,EAAwBkE,gBAAgB,CAAChD,IAAjB,CAAsB,GAAG,KAAKC,WAAL,CAAiBpB,OAAjB,CAAzB,EAAxB,KACK,IAAIqB,KAAK,CAACC,OAAN,CAAcrB,iBAAd,CAAJ,EACHkE,gBAAgB,CAAChD,IAAjB,CACE,GAAG,KAAKC,WAAL,CAAiBpB,OAAjB,EAA0BuB,MAA1B,CACAC,GAAD,IAAS,CAACvB,iBAAiB,CAACwB,QAAlB,CAA2BD,GAA3B,CADT,CADL,EADG,KAMA2C,gBAAgB,CAAChD,IAAjB,CAAsB,GAAGjB,IAAzB;;IAEL,IACE,CAACiE,gBAAgB,CAACzC,IAAjB,CAAuBC,QAAD,IACrBA,QAAQ,CAACC,UAAT,CAAoB,qBAApB,CADD,CADH,EAIE;MACA,IAAItB,IAAJ,EAAU;QACR,wBACEW,aAAa,KAAK,IADpB,EAEE,2EAFF;MAID;;MACDkD,gBAAgB,CAAChD,IAAjB,CAAsB,2BAA2BF,aAAa,IAAI,CAAC,EAAnE;IACD;;IAED,IAAIY,WAAW,GAAG,IAAlB;IACA,IAAIC,iBAAiB,GAAG,IAAxB,CA7CmD,CA+CnD;IACA;;IACA,MAAMsC,eAAe,GAAGD,gBAAgB,CAACnC,SAAjB,CAA4BR,GAAD,IAAQ;MACzD,OAAO,CAAC,UAAD,EAAa,WAAb,EAA0BC,QAA1B,CAAmCD,GAAnC,CAAP;IACD,CAFuB,CAAxB;;IAIA,IAAI4C,eAAe,KAAK,CAAC,CAAzB,EAA4B;MAC1BvC,WAAW,GAAGsC,gBAAgB,CAACC,eAAe,GAAG,CAAnB,CAA9B;;MACA,IAAI,CAACzF,EAAE,CAAC0F,UAAH,CAAcxC,WAAd,CAAL,EAAiC;QAC/B,MAAM,IAAIW,KAAJ,CAAU,iCAAiCX,WAAW,GAAtD,CAAN;MACD,CAJyB,CAM1B;MACA;;;MACAC,iBAAiB,GAAG,KAApB;MACA,MAAMwC,KAAK,GAAG,KAAKC,kBAAL,CAAwBL,iBAAxB,CAAd;MACA,KAAKM,gBAAL,CAAsBF,KAAtB,EAA6BzC,WAA7B;IACD,CAXD,MAWO;MACLA,WAAW,GAAG,MAAM,KAAK4C,cAAL,CAAoBP,iBAApB,CAApB;MACAC,gBAAgB,CAAChD,IAAjB,CAAsB,WAAtB;MACAgD,gBAAgB,CAAChD,IAAjB,CAAsBU,WAAtB;IACD;;IAED,MAAM,KAAK6C,eAAL,EAAN;IACA,IAAIC,iBAAiB,GAAGtE,cAAxB;;IACA,IAAI,CAACA,cAAL,EAAqB;MACnB,MAAM;QAAEiC,WAAF;QAAejC;MAAf,IAAkCkC,qBAAqB,CAAC,IAAD,CAA7D;MACA,IAAID,WAAJ,EAAiB,MAAM,IAAIE,KAAJ,CAAUF,WAAV,CAAN;MACjBqC,iBAAiB,GAAGtE,cAApB;IACD;;IAED,IAAI,CAACsE,iBAAL,EAAwB;MACtB,MAAM,IAAInC,KAAJ,CAAU,iCAAV,CAAN;IACD;;IAED,MAAME,MAAM,GAAG,IAAIC,gCAAJ,CACb,KAAKC,OADQ,EAEb+B,iBAFa,EAGbR,gBAHa,EAIbtC,WAJa,EAKbC,iBALa,CAAf;IAOAY,MAAM,CAACG,KAAP,CAAa;MACXpC,YADW;MAEXD,aAFW;MAGXD,YAHW;MAIXJ,MAJW;MAKXhB,GALW;MAMXmB;IANW,CAAb;IASA,IAAIwC,OAAJ;;IACA,IAAI;MACF,MAAMC,UAAU,GAAG,MAAML,MAAM,CAACM,eAAP,CAAuB;QAC9CP,OAAO,EAAEnC,IADqC;QAE9CS,OAF8C;QAG9CD,MAH8C;QAI9CpB,iBAAiB,EAAE,KAAKG;MAJsB,CAAvB,CAAzB;MAMAiD,OAAO,GAAG,MAAMG,qBAAQC,MAAR,CACdH,UADc,EAEd,EAFc,EAGdrC,iBAHc,EAIdC,eAJc,EAKd+B,MAAM,CAACS,IALO,EAMdT,MAAM,CAACY,KAAP,CAAaC,IAAb,CAAkBb,MAAlB,CANc,CAAhB;IAQD,CAfD,CAeE,OAAOc,KAAP,EAAc;MACdd,MAAM,CAACe,IAAP;MACA,MAAMD,KAAN;IACD;;IAED,IAAIxC,kBAAJ,EAAwB;MACtB,IAAI;QACF,MAAM8B,OAAO,CAACY,aAAR,CAAuBC,CAAD,IAAOA,CAAC,CAACC,IAAF,OAAa,MAA1C,EAAkD;UAAE7C;QAAF,CAAlD,CAAN;MACD,CAFD,CAEE,OAAOyC,KAAP,EAAc;QACd,MAAMV,OAAO,CAACQ,KAAR,EAAN;QACA,MAAME,KAAN;MACD;IACF;;IAED,OAAOV,OAAP;EACD;;EAEDzC,cAAc;IACZ,OAAOkC,qBAAqB,CAAC,IAAD,CAArB,CAA4BlC,cAAnC;EACD;;EAEoB,MAAfqE,eAAe;IACnB;IACA,IAAI,KAAK7E,kBAAL,KAA4B,QAAhC,EAA0C;MACxC,IAAI,CAAC,KAAKD,YAAV,EAAwB;QACtB,MAAM,IAAI4C,KAAJ,CACJ,+DADI,CAAN;MAGD;;MACD,MAAMoC,cAAc,GAAG,IAAIC,kCAAJ,CAAmB,KAAKjF,YAAxB,EAAsC;QAC3DgD,OAAO,EAAE,KAAKA;MAD6C,CAAtC,CAAvB;MAGA,MAAMkC,cAAc,GAAG,MAAMF,cAAc,CAACE,cAAf,EAA7B;MACA,IAAIA,cAAc,CAAC,CAAD,CAAlB,EAAuB,KAAKjF,kBAAL,GAA0BiF,cAAc,CAAC,CAAD,CAAxC;IACxB;EACF;;EAEU,IAAPlC,OAAO;IACT,OAAO,SAAP;EACD;;EAEDxB,WAAW,GAA2C;IAAA,IAA1CpB,OAA0C,uEAAF,EAAE;IACpD,MAAM;MACJ6D,QAAQ,GAAG,KADP;MAEJC,QAAQ,GAAG,CAACD,QAFR;MAGJ3D,IAAI,GAAG,EAHH;MAIJ2B,WAAW,GAAG;IAJV,IAKF7B,OALJ;IAOA,MAAMmE,gBAAgB,GAAG,CAAC,aAAD,CAAzB;IAEA,IAAI9E,EAAE,CAAC0F,QAAH,OAAkB,QAAtB,EAAgCZ,gBAAgB,CAAChD,IAAjB,CAAsB,cAAtB,EAAhC,KACK,IAAI9B,EAAE,CAAC0F,QAAH,GAAcnD,UAAd,CAAyB,KAAzB,CAAJ,EAAqC;MACxCuC,gBAAgB,CAAChD,IAAjB,CAAsB,oBAAtB;IACD;;IACD,IAAIU,WAAJ,EAAiB;MACfsC,gBAAgB,CAAChD,IAAjB,CAAsB,WAAtB;MACAgD,gBAAgB,CAAChD,IAAjB,CAAsBU,WAAtB;IACD;;IACD,IAAIiC,QAAJ,EAAcK,gBAAgB,CAAChD,IAAjB,CAAsB,YAAtB;IACd,IAAI0C,QAAJ,EAAcM,gBAAgB,CAAChD,IAAjB,CAAsB,YAAtB;IACd,IAAIjB,IAAI,CAAC8D,KAAL,CAAYxC,GAAD,IAASA,GAAG,CAACI,UAAJ,CAAe,GAAf,CAApB,CAAJ,EACEuC,gBAAgB,CAAChD,IAAjB,CAAsB,aAAtB;IACFgD,gBAAgB,CAAChD,IAAjB,CAAsB,GAAGjB,IAAzB;IACA,OAAOiE,gBAAP;EACD;;EAEDI,kBAAkB,CAACS,UAAD,EAAqC;IAGrD,MAAMC,MAAM,GAAG,YAAf;IAEA,MAAMC,YAAY,GAAG;MACnB;MACA,wBAAwB,EAFL;MAGnB;MACA,+BAA+B,KAJZ;MAKnB;MACA,iCAAiC,IANd;MAQnB;MACA,gCAAgC,KATb;MAWnB;MACA;MACA,6CACE,uCAdiB;MAgBnB;MACA;MACA;MACA,mCAAmC,IAnBhB;MAoBnB;MACA,8DAA8D,KArB3C;MAsBnB;MACA,8BAA8B,KAvBX;MAwBnB;MACA;MACA,6CAA6C,IA1B1B;MA4BnB;MACA,4CAA4C,KA7BzB;MA8BnB,0CAA0C,KA9BvB;MA+BnB,wCAAwC,KA/BrB;MAgCnB,0CAA0C,KAhCvB;MAiCnB,yCAAyC,KAjCtB;MAmCnB;MACA,yBAAyB,KApCN;MAqCnB;MACA,0CAA0C,KAtCvB;MAuCnB;MACA,qCAAqC,KAxClB;MA0CnB;MACA,4BAA4B,aA3CT;MA4CnB;MACA,4CAA4C,QA7CzB;MA8CnB;MACA,wBAAwB,CA/CL;MAiDnB;MACA;MACA;MACA,+CAA+C,KApD5B;MAqDnB;MACA,qCAAqC,KAtDlB;MAuDnB;MACA,2BAA2B,KAxDR;MA0DnB;MACA,0BAA0B,KA3DP;MA4DnB;MACA;MACA,mCAAmC,KA9DhB;MA+DnB;MACA,oCAAoC,EAhEjB;MAiEnB;MACA,sBAAsB,KAlEH;MAoEnB;MACA,gDAAgD,UAAUD,MAAM,sBArE7C;MAsEnB,qDAAqD,KAtElC;MAuEnB,8CAA8C,KAvE3B;MAwEnB,+CAA+C,KAxE5B;MAyEnB,4CAA4C,KAzEzB;MA2EnB;MACA,8CAA8C,KA5E3B;MA6EnB,+DAA+D,IA7E5C;MA+EnB;MACA;MACA,6BAA6B,KAjFV;MAmFnB;MACA,gCAAgC,KApFb;MAsFnB;MACA;MACA,0BAA0B,IAxFP;MA0FnB;MACA,8BAA8B,KA3FX;MA6FnB;MACA,kCAAkC,CA9Ff;MA+FnB,2BAA2B,CA/FR;MAiGnB;MACA;MACA,gCAAgC,CAnGb;MAoGnB,4BAA4B,CApGT;MAsGnB;MACA,sCAAsC,KAvGnB;MAyGnB;MACA,kCAAkC,KA1Gf;MA4GnB;MACA,mCAAmC,IA7GhB;MA+GnB;MACA,6BAA6B,KAhHV;MAkHnB;MACA,gCAAgC,KAnHb;MAqHnB;MACA,qCAAqC,UAAUA,MAAM,qBAtHlC;MAwHnB;MACA,2BAA2B,KAzHR;MA2HnB;MACA,uCAAuC,CA5HpB;MA8HnB;MACA,yBAAyB,IA/HN;MAgInB;MACA,qCAAqC,KAjIlB;MAkInB;MACA;MACA,wBAAwB,IApIL;MAqInB;MACA,iBAAiB,KAtIE;MAuInB;MACA,uBAAuB,CAxIJ;MAyInB;MACA,oCAAoC,IA1IjB;MA4InB;MACA,mCAAmC,KA7IhB;MA8InB;MACA;MACA,iCAAiC,CAhJd;MAkJnB;MACA,wCAAwC,KAnJrB;MAqJnB;MACA,qCAAqC,KAtJlB;MAwJnB;MACA;MACA,2CAA2C,CA1JxB;MA4JnB;MACA,iCAAiC,KA7Jd;MA+JnB;MACA,sBAAsBA,MAhKH;MAkKnB;MACA,sBAAsB,CAnKH;MAqKnB,sCAAsC,KArKnB;MAuKnB;MACA;MACA,kBAAkB,IAzKC;MA2KnB;MACA,4CAA4C,KA5KzB;MA6KnB;MACA;MACA,yCAAyC,KA/KtB;MAgLnB;MACA,sCAAsC,CAjLnB;MAmLnB;MACA,4BAA4B,UAAUA,MAAM,mBApLzB;MAsLnB;MACA;MACA,wBAAwB,KAxLL;MAyLnB;MACA;MACA,0BAA0B,KA3LP;MA6LnB;MACA,gCAAgC,aA9Lb;MAgMnB;MACA,2CAA2C,EAjMxB;MAmMnB;MACA,sCAAsC,KApMnB;MAsMnB;MACA,uCAAuC,CAAC;IAvMrB,CAArB;IA0MA,OAAOE,MAAM,CAACC,MAAP,CAAcF,YAAd,EAA4BF,UAA5B,CAAP;EACD;EAED;;;;;;;;;;;;EAUsB,MAAhBR,gBAAgB,CACpBF,KADoB,EAEpBe,WAFoB,EAED;IAEnB,MAAMC,KAAK,GAAGH,MAAM,CAACI,OAAP,CAAejB,KAAf,EAAsBkB,GAAtB,CAA0B,QAAiB;MAAA,IAAhB,CAACC,GAAD,EAAMC,KAAN,CAAgB;MACvD,OAAO,aAAaC,IAAI,CAACC,SAAL,CAAeH,GAAf,CAAmB,KAAKE,IAAI,CAACC,SAAL,CAAeF,KAAf,CAAqB,IAAjE;IACD,CAFa,CAAd;IAIA,MAAM3G,cAAc,CAACmD,IAAI,CAACC,IAAL,CAAUkD,WAAV,EAAuB,SAAvB,CAAD,EAAoCC,KAAK,CAACnD,IAAN,CAAW,IAAX,CAApC,CAApB,CANmB,CAQnB;;IACA,MAAM0D,SAAS,GAAG3D,IAAI,CAACC,IAAL,CAAUkD,WAAV,EAAuB,UAAvB,CAAlB;;IACA,IAAI1G,EAAE,CAAC0F,UAAH,CAAcwB,SAAd,CAAJ,EAA8B;MAC5B,MAAMC,eAAe,GAAG5D,IAAI,CAACC,IAAL,CAAUkD,WAAV,EAAuB,oBAAvB,CAAxB;MACA,MAAM3G,aAAa,CAACmH,SAAD,EAAYC,eAAZ,CAAnB;IACD;EACF;;EAEmB,MAAdrB,cAAc,CAACO,UAAD,EAAqC;IACvD,MAAMe,oBAAoB,GAAG,MAAMlH,YAAY,CAC7CqD,IAAI,CAACC,IAAL,CAAUlD,MAAM,EAAhB,EAAoB,gCAApB,CAD6C,CAA/C;IAIA,MAAMqF,KAAK,GAAG,KAAKC,kBAAL,CAAwBS,UAAxB,CAAd;IACA,MAAM,KAAKR,gBAAL,CAAsBF,KAAtB,EAA6ByB,oBAA7B,CAAN;IAEA,OAAOA,oBAAP;EACD;;AA3bkB;;AA8brB,SAAS1D,wBAAT,CAAkCjC,OAAlC,EAA+D;EAC7D,MAAM2E,QAAQ,GAAG1F,EAAE,CAAC0F,QAAH,EAAjB;EAEA,IAAIiB,UAAJ;;EACA,QAAQjB,QAAR;IACE,KAAK,OAAL;MACE,QAAQ3E,OAAR;QACE,KAAK,QAAL;UACE4F,UAAU,GAAG,GAAG9G,OAAO,CAACC,GAAR,CAAY8G,YAAY,2CAAxC;UACA;;QACF,KAAK,aAAL;UACED,UAAU,GAAG,GAAG9G,OAAO,CAACC,GAAR,CAAY8G,YAAY,gDAAxC;UACA;;QACF,KAAK,eAAL;UACED,UAAU,GAAG,GAAG9G,OAAO,CAACC,GAAR,CAAY8G,YAAY,+CAAxC;UACA;;QACF,KAAK,YAAL;UACED,UAAU,GAAG,GAAG9G,OAAO,CAACC,GAAR,CAAY8G,YAAY,+CAAxC;UACA;MAZJ;;MAcA;;IACF,KAAK,QAAL;MACE,QAAQ7F,OAAR;QACE,KAAK,QAAL;UACE4F,UAAU,GACR,8DADF;UAEA;;QACF,KAAK,aAAL;UACEA,UAAU,GACR,wEADF;UAEA;;QACF,KAAK,eAAL;UACEA,UAAU,GACR,4EADF;UAEA;;QACF,KAAK,YAAL;UACEA,UAAU,GACR,sEADF;UAEA;MAhBJ;;MAkBA;;IACF,KAAK,OAAL;MACE,QAAQ5F,OAAR;QACE,KAAK,QAAL;UACE4F,UAAU,GAAG,2BAAb;UACA;;QACF,KAAK,aAAL;UACEA,UAAU,GAAG,gCAAb;UACA;;QACF,KAAK,YAAL;UACEA,UAAU,GAAG,oCAAb;UACA;MATJ;;MAWA;EAjDJ;;EAoDA,IAAI,CAACA,UAAL,EAAiB;IACf,MAAM,IAAIxD,KAAJ,CACJ,iDAAiDpC,OAAO,QAAQ2E,QAAQ,GADpE,CAAN;EAGD,CA5D4D,CA8D7D;;;EACA,IAAI;IACFpG,EAAE,CAACuH,UAAH,CAAcF,UAAd;EACD,CAFD,CAEE,OAAOxC,KAAP,EAAc;IACd,MAAM,IAAIhB,KAAJ,CACJ,wDAAwDpC,OAAO,SAAS4F,UAAU,IAD9E,CAAN;EAGD;;EAED,OAAOA,UAAP;AACD;;AAED,SAASzD,qBAAT,CAA+B4D,QAA/B,EAAyE;EAIvE,MAAM;IAAEvD,OAAF;IAAW9C,gBAAX;IAA6BF,YAA7B;IAA2CC;EAA3C,IACJsG,QADF;EAEA,IAAIC,YAAJ,CANuE,CAOvE;;EACA,IAAI,CAACtG,gBAAL,EAAuB;IACrB,MAAMO,cAAc,GAClBnB,OAAO,CAACC,GAAR,CAAYkH,yBAAZ,IACAnH,OAAO,CAACC,GAAR,CAAYmH,oCADZ,IAEApH,OAAO,CAACC,GAAR,CAAYoH,4CAHd;;IAIA,IAAIlG,cAAJ,EAAoB;MAClB,MAAMiC,WAAW,GAAG,CAAC3D,EAAE,CAAC0F,UAAH,CAAchE,cAAd,CAAD,GAChB,+GACAA,cAFgB,GAGhBgD,SAHJ;MAIA,OAAO;QAAEhD,cAAF;QAAkBiC;MAAlB,CAAP;IACD;;IACD,MAAMkE,kBAAkB,GAAG,2BAA3B;;IACA,IACE5D,OAAO,KAAK,QAAZ,IACAvD,EAAE,CAAC0F,QAAH,OAAkB,QADlB,IAEA1F,EAAE,CAACoH,IAAH,OAAc,OAFd,IAGA9H,EAAE,CAAC0F,UAAH,CAAcmC,kBAAd,CAJF,EAKE;MACA,OAAO;QAAEnG,cAAc,EAAEmG,kBAAlB;QAAsClE,WAAW,EAAEe;MAAnD,CAAP;IACD;;IACD+C,YAAY,GACVlH,OAAO,CAACC,GAAR,CAAYuH,uBAAZ,IACAxH,OAAO,CAACC,GAAR,CAAYwH,kCADZ,IAEAzH,OAAO,CAACC,GAAR,CAAYyH,0CAHd;EAID;;EACD,IAAI,CAAChH,YAAL,EAAmB;IACjB,MAAM,IAAI4C,KAAJ,CACJ,+DADI,CAAN;EAGD;;EACD,MAAMoC,cAAc,GAAG,IAAIC,kCAAJ,CAAmBjF,YAAnB,EAAiC;IACtDgD,OAAO,EAAEA,OAD6C;IAEtDV,IAAI,EAAEkE;EAFgD,CAAjC,CAAvB;;EAKA,IAAI,CAACtG,gBAAD,IAAqB8C,OAAO,KAAK,QAArC,EAA+C;IAC7C,MAAMiE,QAAQ,GAAG3H,OAAO,CAACC,GAAR,CAAY,6BAAZ,CAAjB;;IACA,IAAI0H,QAAJ,EAAc;MACZ,MAAMC,YAAY,GAAGlC,cAAc,CAACkC,YAAf,CAA4BD,QAA5B,CAArB;MACA,MAAMvE,WAAW,GAAG,CAACwE,YAAY,CAACC,KAAd,GAChB,6GACAD,YAAY,CAACzG,cAFG,GAGhBgD,SAHJ;MAIA,OAAO;QAAEhD,cAAc,EAAEyG,YAAY,CAACzG,cAA/B;QAA+CiC;MAA/C,CAAP;IACD;EACF;;EACD,MAAMwE,YAAY,GAAGlC,cAAc,CAACkC,YAAf,CAA4BjH,kBAA5B,CAArB;EAEA,MAAMmH,WAAW,GAAG,+FAApB;EACA,MAAMC,UAAU,GAAG,kEAAkEd,QAAQ,CAACtG,kBAAkB,IAAhH;EACA,MAAMyC,WAAW,GAAG,CAACwE,YAAY,CAACC,KAAd,GAChB,oCAAoCnE,OAAO,cACzCA,OAAO,KAAK,QAAZ,GAAuBqE,UAAvB,GAAoCD,WACtC,EAHgB,GAIhB3D,SAJJ;EAKA,OAAO;IAAEhD,cAAc,EAAEyG,YAAY,CAACzG,cAA/B;IAA+CiC;EAA/C,CAAP;AACD;AAED;;;;;AAGA,SAAwB4E,QAAxB,CACEzH,WADF,EAEEC,iBAFF,EAGEC,eAHF,EAIEiD,OAJF,EAIkB;EAEhB;EACA,IAAI,CAACA,OAAD,IAAY,CAACjD,eAAjB,EACEiD,OAAO,GACL1D,OAAO,CAACC,GAAR,CAAYgI,iBAAZ,IACAjI,OAAO,CAACC,GAAR,CAAYiI,4BADZ,IAEAlI,OAAO,CAACC,GAAR,CAAYkI,oCAHd;;EAIF,QAAQzE,OAAR;IACE,KAAK,SAAL;MACE,OAAO,IAAIqB,eAAJ,CACLxE,WADK,EAELC,iBAFK,EAGLC,eAHK,CAAP;;IAKF,KAAK,QAAL;IACA;MACE,IAAI,OAAOiD,OAAP,KAAmB,WAAnB,IAAkCA,OAAO,KAAK,QAAlD,EAA4D;QAC1D;;;;QAIA0E,OAAO,CAACC,IAAR,CACE,iCAAiC3E,OAAO,2BAD1C;MAGD;;MACD,OAAO,IAAIrD,cAAJ,CACLE,WADK,EAELC,iBAFK,EAGLC,eAHK,CAAP;EAlBJ;AAwBD;;AApCD6H","names":["copyFileAsync","fs","copyFile","mkdtempAsync","mkdtemp","writeFileAsync","writeFile","tmpDir","process","env","PUPPETEER_TMP_DIR","os","tmpdir","ChromeLauncher","constructor","projectRoot","preferredRevision","isPuppeteerCore","_projectRoot","_preferredRevision","_isPuppeteerCore","launch","options","ignoreDefaultArgs","args","dumpio","channel","executablePath","pipe","handleSIGINT","handleSIGTERM","handleSIGHUP","ignoreHTTPSErrors","defaultViewport","width","height","slowMo","timeout","waitForInitialPage","debuggingPort","chromeArguments","push","defaultArgs","Array","isArray","filter","arg","includes","some","argument","startsWith","userDataDir","isTempUserDataDir","userDataDirIndex","findIndex","split","path","join","chromeExecutable","executablePathForChannel","missingText","resolveExecutablePath","Error","usePipe","runner","BrowserRunner_js_1","product","start","browser","connection","setupConnection","Browser_js_1","create","proc","_a","undefined","close","bind","error","kill","waitForTarget","t","type","devtools","headless","resolve","every","FirefoxLauncher","extraPrefsFirefox","firefoxArguments","profileArgIndex","existsSync","prefs","defaultPreferences","writePreferences","_createProfile","_updateRevision","firefoxExecutable","browserFetcher","BrowserFetcher_js_1","localRevisions","platform","extraPrefs","server","defaultPrefs","Object","assign","profilePath","lines","entries","map","key","value","JSON","stringify","prefsPath","prefsBackupPath","temporaryProfilePath","chromePath","PROGRAMFILES","accessSync","launcher","downloadPath","PUPPETEER_EXECUTABLE_PATH","npm_config_puppeteer_executable_path","npm_package_config_puppeteer_executable_path","ubuntuChromiumPath","arch","PUPPETEER_DOWNLOAD_PATH","npm_config_puppeteer_download_path","npm_package_config_puppeteer_download_path","revision","revisionInfo","local","firefoxHelp","chromeHelp","Launcher","PUPPETEER_PRODUCT","npm_config_puppeteer_product","npm_package_config_puppeteer_product","console","warn","exports"],"sources":["../../../../src/node/Launcher.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}