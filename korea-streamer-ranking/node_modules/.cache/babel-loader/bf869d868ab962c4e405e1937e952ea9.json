{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NodeWebSocketTransport = void 0;\n\nconst ws_1 = __importDefault(require(\"ws\"));\n\nclass NodeWebSocketTransport {\n  constructor(ws) {\n    this._ws = ws;\n\n    this._ws.addEventListener('message', event => {\n      if (this.onmessage) this.onmessage.call(null, event.data);\n    });\n\n    this._ws.addEventListener('close', () => {\n      if (this.onclose) this.onclose.call(null);\n    }); // Silently ignore all errors - we don't know what to do with them.\n\n\n    this._ws.addEventListener('error', () => {});\n\n    this.onmessage = null;\n    this.onclose = null;\n  }\n\n  static create(url) {\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\n    const pkg = require('../../../../package.json');\n\n    return new Promise((resolve, reject) => {\n      const ws = new ws_1.default(url, [], {\n        followRedirects: true,\n        perMessageDeflate: false,\n        maxPayload: 256 * 1024 * 1024,\n        headers: {\n          'User-Agent': `Puppeteer ${pkg.version}`\n        }\n      });\n      ws.addEventListener('open', () => resolve(new NodeWebSocketTransport(ws)));\n      ws.addEventListener('error', reject);\n    });\n  }\n\n  send(message) {\n    this._ws.send(message);\n  }\n\n  close() {\n    this._ws.close();\n  }\n\n}\n\nexports.NodeWebSocketTransport = NodeWebSocketTransport;","map":{"version":3,"mappings":";;;;;;;;;;;;;AAgBA;;AAEA,MAAaA,sBAAb,CAAmC;EAyBjCC,YAAYC,EAAZ,EAA6B;IAC3B,KAAKC,GAAL,GAAWD,EAAX;;IACA,KAAKC,GAAL,CAASC,gBAAT,CAA0B,SAA1B,EAAsCC,KAAD,IAAU;MAC7C,IAAI,KAAKC,SAAT,EAAoB,KAAKA,SAAL,CAAeC,IAAf,CAAoB,IAApB,EAA0BF,KAAK,CAACG,IAAhC;IACrB,CAFD;;IAGA,KAAKL,GAAL,CAASC,gBAAT,CAA0B,OAA1B,EAAmC,MAAK;MACtC,IAAI,KAAKK,OAAT,EAAkB,KAAKA,OAAL,CAAaF,IAAb,CAAkB,IAAlB;IACnB,CAFD,EAL2B,CAQ3B;;;IACA,KAAKJ,GAAL,CAASC,gBAAT,CAA0B,OAA1B,EAAmC,MAAK,CAAG,CAA3C;;IACA,KAAKE,SAAL,GAAiB,IAAjB;IACA,KAAKG,OAAL,GAAe,IAAf;EACD;;EApCY,OAANC,MAAM,CAACC,GAAD,EAAY;IACvB;IACA,MAAMC,GAAG,GAAGC,OAAO,CAAC,0BAAD,CAAnB;;IACA,OAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAoB;MACrC,MAAMd,EAAE,GAAG,IAAIe,YAAJ,CAAkBN,GAAlB,EAAuB,EAAvB,EAA2B;QACpCO,eAAe,EAAE,IADmB;QAEpCC,iBAAiB,EAAE,KAFiB;QAGpCC,UAAU,EAAE,MAAM,IAAN,GAAa,IAHW;QAIpCC,OAAO,EAAE;UACP,cAAc,aAAaT,GAAG,CAACU,OAAO;QAD/B;MAJ2B,CAA3B,CAAX;MASApB,EAAE,CAACE,gBAAH,CAAoB,MAApB,EAA4B,MAC1BW,OAAO,CAAC,IAAIf,sBAAJ,CAA2BE,EAA3B,CAAD,CADT;MAGAA,EAAE,CAACE,gBAAH,CAAoB,OAApB,EAA6BY,MAA7B;IACD,CAdM,CAAP;EAeD;;EAoBDO,IAAI,CAACC,OAAD,EAAgB;IAClB,KAAKrB,GAAL,CAASoB,IAAT,CAAcC,OAAd;EACD;;EAEDC,KAAK;IACH,KAAKtB,GAAL,CAASsB,KAAT;EACD;;AA7CgC;;AAAnCC","names":["NodeWebSocketTransport","constructor","ws","_ws","addEventListener","event","onmessage","call","data","onclose","create","url","pkg","require","Promise","resolve","reject","ws_1","followRedirects","perMessageDeflate","maxPayload","headers","version","send","message","close","exports"],"sources":["../../../../src/node/NodeWebSocketTransport.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}